var gi=Object.create;var Ft=Object.defineProperty;var xi=Object.getOwnPropertyDescriptor;var yi=Object.getOwnPropertyNames;var vi=Object.getPrototypeOf,_i=Object.prototype.hasOwnProperty;var $o=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),Do=(e,t)=>{for(var n in t)Ft(e,n,{get:t[n],enumerable:!0})},Lo=(e,t,n,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let a of yi(t))!_i.call(e,a)&&a!==n&&Ft(e,a,{get:()=>t[a],enumerable:!(i=xi(t,a))||i.enumerable});return e};var wi=(e,t,n)=>(n=e!=null?gi(vi(e)):{},Lo(t||!e||!e.__esModule?Ft(n,"default",{value:e,enumerable:!0}):n,e)),Ai=e=>Lo(Ft({},"__esModule",{value:!0}),e);var Sn=$o(()=>{});var Cn=$o((exports,module)=>{(function(e,t,n){typeof module<"u"&&module.exports?module.exports=n():typeof define=="function"&&define.amd?define(n):t[e]=n()})("reqwest",exports,function(){var context=this;if("window"in context)var doc=document,byTag="getElementsByTagName",head=doc[byTag]("head")[0];else{var XHR2;try{XHR2=Sn()}catch{throw new Error("Peer dependency `xhr2` required! Please npm install xhr2")}}var httpsRe=/^http/,protocolRe=/(^\w+):\/\//,twoHundo=/^(20\d|1223)$/,readyState="readyState",contentType="Content-Type",requestedWith="X-Requested-With",uniqid=0,callbackPrefix="reqwest_"+ +new Date,lastValue,xmlHttpRequest="XMLHttpRequest",xDomainRequest="XDomainRequest",noop=function(){},isArray=typeof Array.isArray=="function"?Array.isArray:function(e){return e instanceof Array},defaultHeaders={contentType:"application/x-www-form-urlencoded",requestedWith:xmlHttpRequest,accept:{"*":"text/javascript, text/html, application/xml, text/xml, */*",xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript",js:"application/javascript, text/javascript"}},xhr=function(e){if(e.crossOrigin===!0){var t=context[xmlHttpRequest]?new XMLHttpRequest:null;if(t&&"withCredentials"in t)return t;if(context[xDomainRequest])return new XDomainRequest;throw new Error("Browser does not support cross-origin requests")}else return context[xmlHttpRequest]?new XMLHttpRequest:XHR2?new XHR2:new ActiveXObject("Microsoft.XMLHTTP")},globalSetupOptions={dataFilter:function(e){return e}};function succeed(e){var t=protocolRe.exec(e.url);return t=t&&t[1]||context.location.protocol,httpsRe.test(t)?twoHundo.test(e.request.status):!!e.request.response}function handleReadyState(e,t,n){return function(){if(e._aborted)return n(e.request);if(e._timedOut)return n(e.request,"Request is aborted: timeout");e.request&&e.request[readyState]==4&&(e.request.onreadystatechange=noop,succeed(e)?t(e.request):n(e.request))}}function setHeaders(e,t){var n=t.headers||{},i;n.Accept=n.Accept||defaultHeaders.accept[t.type]||defaultHeaders.accept["*"];var a=typeof FormData<"u"&&t.data instanceof FormData;!t.crossOrigin&&!n[requestedWith]&&(n[requestedWith]=defaultHeaders.requestedWith),!n[contentType]&&!a&&(n[contentType]=t.contentType||defaultHeaders.contentType);for(i in n)n.hasOwnProperty(i)&&"setRequestHeader"in e&&e.setRequestHeader(i,n[i])}function setCredentials(e,t){typeof t.withCredentials<"u"&&typeof e.withCredentials<"u"&&(e.withCredentials=!!t.withCredentials)}function generalCallback(e){lastValue=e}function urlappend(e,t){return e+(/\?/.test(e)?"&":"?")+t}function handleJsonp(e,t,n,i){var a=uniqid++,s=e.jsonpCallback||"callback",f=e.jsonpCallbackName||reqwest.getcallbackPrefix(a),l=new RegExp("((^|\\?|&)"+s+")=([^&]+)"),h=i.match(l),p=doc.createElement("script"),R=0,b=navigator.userAgent.indexOf("MSIE 10.0")!==-1;return h?h[3]==="?"?i=i.replace(l,"$1="+f):f=h[3]:i=urlappend(i,s+"="+f),context[f]=generalCallback,p.type="text/javascript",p.src=i,p.async=!0,typeof p.onreadystatechange<"u"&&!b&&(p.htmlFor=p.id="_reqwest_"+a),p.onload=p.onreadystatechange=function(){if(p[readyState]&&p[readyState]!=="complete"&&p[readyState]!=="loaded"||R)return!1;p.onload=p.onreadystatechange=null,p.onclick&&p.onclick(),t(lastValue),lastValue=void 0,head.removeChild(p),R=1},head.appendChild(p),{abort:function(){p.onload=p.onreadystatechange=null,n({},"Request is aborted: timeout",{}),lastValue=void 0,head.removeChild(p),R=1}}}function getRequest(e,t){var n=this.o,i=(n.method||"GET").toUpperCase(),a=typeof n=="string"?n:n.url,s=n.processData!==!1&&n.data&&typeof n.data!="string"?reqwest.toQueryString(n.data):n.data||null,f,l=!1;return(n.type=="jsonp"||i=="GET")&&s&&(a=urlappend(a,s),s=null),n.type=="jsonp"?handleJsonp(n,e,t,a):(f=n.xhr&&n.xhr(n)||xhr(n),f.open(i,a,n.async!==!1),setHeaders(f,n),setCredentials(f,n),context[xDomainRequest]&&f instanceof context[xDomainRequest]?(f.onload=e,f.onerror=t,f.onprogress=function(){},l=!0):f.onreadystatechange=handleReadyState(this,e,t),n.before&&n.before(f),l?setTimeout(function(){f.send(s)},200):f.send(s),f)}function Reqwest(e,t){this.o=e,this.fn=t,init.apply(this,arguments)}function setType(e){if(e!==null){if(e.match("json"))return"json";if(e.match("javascript"))return"js";if(e.match("text"))return"html";if(e.match("xml"))return"xml"}}function init(o,fn){this.url=typeof o=="string"?o:o.url,this.timeout=null,this._fulfilled=!1,this._successHandler=function(){},this._fulfillmentHandlers=[],this._errorHandlers=[],this._completeHandlers=[],this._erred=!1,this._responseArgs={};var self=this;fn=fn||function(){},o.timeout&&(this.timeout=setTimeout(function(){timedOut()},o.timeout)),o.success&&(this._successHandler=function(){o.success.apply(o,arguments)}),o.error&&this._errorHandlers.push(function(){o.error.apply(o,arguments)}),o.complete&&this._completeHandlers.push(function(){o.complete.apply(o,arguments)});function complete(e){for(o.timeout&&clearTimeout(self.timeout),self.timeout=null;self._completeHandlers.length>0;)self._completeHandlers.shift()(e)}function success(resp){var type=o.type||resp&&setType(resp.getResponseHeader("Content-Type"));resp=type!=="jsonp"?self.request:resp;var filteredResponse=globalSetupOptions.dataFilter(resp.responseText,type),r=filteredResponse;try{resp.responseText=r}catch(e){}if(r)switch(type){case"json":try{resp=context.JSON?context.JSON.parse(r):eval("("+r+")")}catch(e){return error(resp,"Could not parse JSON in response",e)}break;case"js":resp=eval(r);break;case"html":resp=r;break;case"xml":resp=resp.responseXML&&resp.responseXML.parseError&&resp.responseXML.parseError.errorCode&&resp.responseXML.parseError.reason?null:resp.responseXML;break}for(self._responseArgs.resp=resp,self._fulfilled=!0,fn(resp),self._successHandler(resp);self._fulfillmentHandlers.length>0;)resp=self._fulfillmentHandlers.shift()(resp);complete(resp)}function timedOut(){self._timedOut=!0,self.request.abort()}function error(e,t,n){for(e=self.request,self._responseArgs.resp=e,self._responseArgs.msg=t,self._responseArgs.t=n,self._erred=!0;self._errorHandlers.length>0;)self._errorHandlers.shift()(e,t,n);complete(e)}this.request=getRequest.call(this,success,error)}Reqwest.prototype={abort:function(){this._aborted=!0,this.request.abort()},retry:function(){init.call(this,this.o,this.fn)},then:function(e,t){return e=e||function(){},t=t||function(){},this._fulfilled?this._responseArgs.resp=e(this._responseArgs.resp):this._erred?t(this._responseArgs.resp,this._responseArgs.msg,this._responseArgs.t):(this._fulfillmentHandlers.push(e),this._errorHandlers.push(t)),this},always:function(e){return this._fulfilled||this._erred?e(this._responseArgs.resp):this._completeHandlers.push(e),this},fail:function(e){return this._erred?e(this._responseArgs.resp,this._responseArgs.msg,this._responseArgs.t):this._errorHandlers.push(e),this},catch:function(e){return this.fail(e)}};function reqwest(e,t){return new Reqwest(e,t)}function normalize(e){return e?e.replace(/\r?\n/g,`\r
`):""}function serial(e,t){var n=e.name,i=e.tagName.toLowerCase(),a=function(p){p&&!p.disabled&&t(n,normalize(p.attributes.value&&p.attributes.value.specified?p.value:p.text))},s,f,l,h;if(!(e.disabled||!n))switch(i){case"input":/reset|button|image|file/i.test(e.type)||(s=/checkbox/i.test(e.type),f=/radio/i.test(e.type),l=e.value,(!(s||f)||e.checked)&&t(n,normalize(s&&l===""?"on":l)));break;case"textarea":t(n,normalize(e.value));break;case"select":if(e.type.toLowerCase()==="select-one")a(e.selectedIndex>=0?e.options[e.selectedIndex]:null);else for(h=0;e.length&&h<e.length;h++)e.options[h].selected&&a(e.options[h]);break}}function eachFormElement(){var e=this,t,n,i=function(a,s){var f,l,h;for(f=0;f<s.length;f++)for(h=a[byTag](s[f]),l=0;l<h.length;l++)serial(h[l],e)};for(n=0;n<arguments.length;n++)t=arguments[n],/input|select|textarea/i.test(t.tagName)&&serial(t,e),i(t,["input","select","textarea"])}function serializeQueryString(){return reqwest.toQueryString(reqwest.serializeArray.apply(null,arguments))}function serializeHash(){var e={};return eachFormElement.apply(function(t,n){t in e?(e[t]&&!isArray(e[t])&&(e[t]=[e[t]]),e[t].push(n)):e[t]=n},arguments),e}reqwest.serializeArray=function(){var e=[];return eachFormElement.apply(function(t,n){e.push({name:t,value:n})},arguments),e},reqwest.serialize=function(){if(arguments.length===0)return"";var e,t,n=Array.prototype.slice.call(arguments,0);return e=n.pop(),e&&e.nodeType&&n.push(e)&&(e=null),e&&(e=e.type),e=="map"?t=serializeHash:e=="array"?t=reqwest.serializeArray:t=serializeQueryString,t.apply(null,n)},reqwest.toQueryString=function(e,t){var n,i,a=t||!1,s=[],f=encodeURIComponent,l=function(h,p){p=typeof p=="function"?p():p??"",s[s.length]=f(h)+"="+f(p)};if(isArray(e))for(i=0;e&&i<e.length;i++)l(e[i].name,e[i].value);else for(n in e)e.hasOwnProperty(n)&&buildParams(n,e[n],a,l);return s.join("&").replace(/%20/g,"+")};function buildParams(e,t,n,i){var a,s,f,l=/\[\]$/;if(isArray(t))for(s=0;t&&s<t.length;s++)f=t[s],n||l.test(e)?i(e,f):buildParams(e+"["+(typeof f=="object"?s:"")+"]",f,n,i);else if(t&&t.toString()==="[object Object]")for(a in t)buildParams(e+"["+a+"]",t[a],n,i);else i(e,t)}return reqwest.getcallbackPrefix=function(){return callbackPrefix},reqwest.compat=function(e,t){return e&&(e.type&&(e.method=e.type)&&delete e.type,e.dataType&&(e.type=e.dataType),e.jsonpCallback&&(e.jsonpCallbackName=e.jsonpCallback)&&delete e.jsonpCallback,e.jsonp&&(e.jsonpCallback=e.jsonp)),new Reqwest(e,t)},reqwest.ajaxSetup=function(e){e=e||{};for(var t in e)globalSetupOptions[t]=e[t]},reqwest})});var Es={};Do(Es,{Pride:()=>In});module.exports=Ai(Es);var Ei={array:[],get:function(e){return this.array.find(t=>t.get("uid")===e)}},Se=Ei;var Ri=function(e,t,n){return Array.prototype.slice.call(e,t,n)},G=Ri;var Oi=function(e){return!!e&&(Object.prototype.toString.call(e)==="[object Function]"||typeof e=="function"||e instanceof Function)},K=Oi;var bi=function(e,t,n){return function(i){this.children=G(arguments,1),this.children.length===1&&Array.isArray(this.children[0])&&(this.children=this.children[0]),this.type=e,this.value=i.trim(),this.childTypes=t||[],this.addChild=function(a){if(!t.find(s=>a.type===s))throw new Error(`Not a valid child for a ${this.type}`);return this.children.push(a),this},this.contains=function(a){return this.matches(a)?this:this.children.length===0?!1:this.children.find(s=>s.contains(a))},this.matches=function(a){let s=this,f=a.children||[];return delete a.children,Object.keys(a).every(l=>s[l]===a[l])&&f.every(l=>f.some(h=>l.matches(h)))},this.serialize=function(){return i},this.serializedChildren=function(){let a=[];return this.children.forEach(s=>{a.push(s.serialize())}),a},this.toJSON=function(){let a={...this};return Object.keys(a).forEach(s=>{["value","children","type"].includes(s)||delete a[s]}),a.children.forEach(s=>{s.toJSON()}),a},K(n)&&n.call(this)}},I=bi;var Fi=function(e,t){return I(e,t,function(){if(!["AND","OR","NOT"].includes(this.value))throw new Error("Not a valid boolean value");this.serializedChildren=function(){return this.children.map(n=>n.type===this.type||n.type==="literal"&&n.value.match(/\s/)?`(${n.serialize()})`:n.serialize())},this.serialize=function(){return this.serializedChildren().join(` ${this.value} `)}})},Ce=Fi;var go={};Do(go,{VERSION:()=>qt,after:()=>Zr,all:()=>Qt,allKeys:()=>Z,any:()=>Wt,assign:()=>_e,before:()=>lt,bind:()=>kt,bindAll:()=>pn,chain:()=>Xr,chunk:()=>ho,clone:()=>$r,collect:()=>X,compact:()=>uo,compose:()=>Yr,constant:()=>Ze,contains:()=>B,countBy:()=>vn,create:()=>Nr,debounce:()=>Gr,default:()=>On,defaults:()=>Bt,defer:()=>mn,delay:()=>It,detect:()=>He,difference:()=>Gt,drop:()=>be,each:()=>$,escape:()=>an,every:()=>Qt,extend:()=>Lt,extendOwn:()=>_e,filter:()=>Y,find:()=>He,findIndex:()=>Be,findKey:()=>ct,findLastIndex:()=>Vt,findWhere:()=>jr,first:()=>_t,flatten:()=>lo,foldl:()=>Xt,foldr:()=>eo,forEach:()=>$,functions:()=>$e,get:()=>it,groupBy:()=>xn,has:()=>Lr,head:()=>_t,identity:()=>Ae,include:()=>B,includes:()=>B,indexBy:()=>yn,indexOf:()=>Ut,initial:()=>vt,inject:()=>Xt,intersection:()=>co,invert:()=>ot,invoke:()=>gn,isArguments:()=>Me,isArray:()=>V,isArrayBuffer:()=>Mt,isBoolean:()=>Ke,isDataView:()=>xe,isDate:()=>Xo,isElement:()=>Er,isEmpty:()=>Fr,isEqual:()=>Sr,isError:()=>Wo,isFinite:()=>br,isFunction:()=>q,isMap:()=>rn,isMatch:()=>rt,isNaN:()=>Ye,isNull:()=>Ar,isNumber:()=>Tt,isObject:()=>L,isRegExp:()=>Qo,isSet:()=>nn,isString:()=>Te,isSymbol:()=>Pt,isTypedArray:()=>$t,isUndefined:()=>Ge,isWeakMap:()=>on,isWeakSet:()=>sn,iteratee:()=>De,keys:()=>w,last:()=>fo,lastIndexOf:()=>hn,map:()=>X,mapObject:()=>Br,matcher:()=>oe,matches:()=>oe,max:()=>gt,memoize:()=>Wr,methods:()=>$e,min:()=>oo,mixin:()=>wt,negate:()=>Re,noop:()=>at,now:()=>ue,object:()=>po,omit:()=>wn,once:()=>dn,pairs:()=>Mr,partial:()=>le,partition:()=>_n,pick:()=>Jt,pluck:()=>Oe,property:()=>Ee,propertyOf:()=>Hr,random:()=>Le,range:()=>mo,reduce:()=>Xt,reduceRight:()=>eo,reject:()=>to,rest:()=>be,restArguments:()=>F,result:()=>Vr,sample:()=>yt,select:()=>Y,shuffle:()=>no,size:()=>so,some:()=>Wt,sortBy:()=>io,sortedIndex:()=>mt,tail:()=>be,take:()=>_t,tap:()=>Dr,template:()=>Ir,templateSettings:()=>cn,throttle:()=>Jr,times:()=>zr,toArray:()=>xt,toPath:()=>Ht,transpose:()=>ke,unescape:()=>ln,union:()=>En,uniq:()=>ze,unique:()=>ze,uniqueId:()=>Ur,unzip:()=>ke,values:()=>Q,where:()=>ro,without:()=>An,wrap:()=>Kr,zip:()=>Rn});var qt="1.13.6",hr=typeof self=="object"&&self.self===self&&self||typeof global=="object"&&global.global===global&&global||Function("return this")()||{},Je=Array.prototype,St=Object.prototype,gr=typeof Symbol<"u"?Symbol.prototype:null,Bo=Je.push,re=Je.slice,ie=St.toString,Ho=St.hasOwnProperty,xr=typeof ArrayBuffer<"u",zo=typeof DataView<"u",ko=Array.isArray,yr=Object.keys,vr=Object.create,_r=xr&&ArrayBuffer.isView,Io=isNaN,Vo=isFinite,Ct=!{toString:null}.propertyIsEnumerable("toString"),wr=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],Uo=Math.pow(2,53)-1;function F(e,t){return t=t==null?e.length-1:+t,function(){for(var n=Math.max(arguments.length-t,0),i=Array(n),a=0;a<n;a++)i[a]=arguments[a+t];switch(t){case 0:return e.call(this,i);case 1:return e.call(this,arguments[0],i);case 2:return e.call(this,arguments[0],arguments[1],i)}var s=Array(t+1);for(a=0;a<t;a++)s[a]=arguments[a];return s[t]=i,e.apply(this,s)}}function L(e){var t=typeof e;return t==="function"||t==="object"&&!!e}function Ar(e){return e===null}function Ge(e){return e===void 0}function Ke(e){return e===!0||e===!1||ie.call(e)==="[object Boolean]"}function Er(e){return!!(e&&e.nodeType===1)}function E(e){var t="[object "+e+"]";return function(n){return ie.call(n)===t}}var Te=E("String");var Tt=E("Number");var Xo=E("Date");var Qo=E("RegExp");var Wo=E("Error");var Pt=E("Symbol");var Mt=E("ArrayBuffer");var Jo=E("Function"),qi=hr.document&&hr.document.childNodes;typeof/./!="function"&&typeof Int8Array!="object"&&typeof qi!="function"&&(Jo=function(e){return typeof e=="function"||!1});var q=Jo;var Rr=E("Object");var Nt=zo&&Rr(new DataView(new ArrayBuffer(8))),Pe=typeof Map<"u"&&Rr(new Map);var Si=E("DataView");function Ci(e){return e!=null&&q(e.getInt8)&&Mt(e.buffer)}var xe=Nt?Ci:Si;var V=ko||E("Array");function N(e,t){return e!=null&&Ho.call(e,t)}var Or=E("Arguments");(function(){Or(arguments)||(Or=function(e){return N(e,"callee")})})();var Me=Or;function br(e){return!Pt(e)&&Vo(e)&&!isNaN(parseFloat(e))}function Ye(e){return Tt(e)&&Io(e)}function Ze(e){return function(){return e}}function je(e){return function(t){var n=e(t);return typeof n=="number"&&n>=0&&n<=Uo}}function et(e){return function(t){return t?.[e]}}var ye=et("byteLength");var Go=je(ye);var Ti=/\[object ((I|Ui)nt(8|16|32)|Float(32|64)|Uint8Clamped|Big(I|Ui)nt64)Array\]/;function Pi(e){return _r?_r(e)&&!xe(e):Go(e)&&Ti.test(ie.call(e))}var $t=xr?Pi:Ze(!1);var C=et("length");function Mi(e){for(var t={},n=e.length,i=0;i<n;++i)t[e[i]]=!0;return{contains:function(a){return t[a]===!0},push:function(a){return t[a]=!0,e.push(a)}}}function tt(e,t){t=Mi(t);var n=wr.length,i=e.constructor,a=q(i)&&i.prototype||St,s="constructor";for(N(e,s)&&!t.contains(s)&&t.push(s);n--;)s=wr[n],s in e&&e[s]!==a[s]&&!t.contains(s)&&t.push(s)}function w(e){if(!L(e))return[];if(yr)return yr(e);var t=[];for(var n in e)N(e,n)&&t.push(n);return Ct&&tt(e,t),t}function Fr(e){if(e==null)return!0;var t=C(e);return typeof t=="number"&&(V(e)||Te(e)||Me(e))?t===0:C(w(e))===0}function rt(e,t){var n=w(t),i=n.length;if(e==null)return!i;for(var a=Object(e),s=0;s<i;s++){var f=n[s];if(t[f]!==a[f]||!(f in a))return!1}return!0}function y(e){if(e instanceof y)return e;if(!(this instanceof y))return new y(e);this._wrapped=e}y.VERSION=qt;y.prototype.value=function(){return this._wrapped};y.prototype.valueOf=y.prototype.toJSON=y.prototype.value;y.prototype.toString=function(){return String(this._wrapped)};function Dt(e){return new Uint8Array(e.buffer||e,e.byteOffset||0,ye(e))}var Ko="[object DataView]";function qr(e,t,n,i){if(e===t)return e!==0||1/e===1/t;if(e==null||t==null)return!1;if(e!==e)return t!==t;var a=typeof e;return a!=="function"&&a!=="object"&&typeof t!="object"?!1:Yo(e,t,n,i)}function Yo(e,t,n,i){e instanceof y&&(e=e._wrapped),t instanceof y&&(t=t._wrapped);var a=ie.call(e);if(a!==ie.call(t))return!1;if(Nt&&a=="[object Object]"&&xe(e)){if(!xe(t))return!1;a=Ko}switch(a){case"[object RegExp]":case"[object String]":return""+e==""+t;case"[object Number]":return+e!=+e?+t!=+t:+e==0?1/+e===1/t:+e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object Symbol]":return gr.valueOf.call(e)===gr.valueOf.call(t);case"[object ArrayBuffer]":case Ko:return Yo(Dt(e),Dt(t),n,i)}var s=a==="[object Array]";if(!s&&$t(e)){var f=ye(e);if(f!==ye(t))return!1;if(e.buffer===t.buffer&&e.byteOffset===t.byteOffset)return!0;s=!0}if(!s){if(typeof e!="object"||typeof t!="object")return!1;var l=e.constructor,h=t.constructor;if(l!==h&&!(q(l)&&l instanceof l&&q(h)&&h instanceof h)&&"constructor"in e&&"constructor"in t)return!1}n=n||[],i=i||[];for(var p=n.length;p--;)if(n[p]===e)return i[p]===t;if(n.push(e),i.push(t),s){if(p=e.length,p!==t.length)return!1;for(;p--;)if(!qr(e[p],t[p],n,i))return!1}else{var R=w(e),b;if(p=R.length,w(t).length!==p)return!1;for(;p--;)if(b=R[p],!(N(t,b)&&qr(e[b],t[b],n,i)))return!1}return n.pop(),i.pop(),!0}function Sr(e,t){return qr(e,t)}function Z(e){if(!L(e))return[];var t=[];for(var n in e)t.push(n);return Ct&&tt(e,t),t}function Ne(e){var t=C(e);return function(n){if(n==null)return!1;var i=Z(n);if(C(i))return!1;for(var a=0;a<t;a++)if(!q(n[e[a]]))return!1;return e!==Pr||!q(n[Cr])}}var Cr="forEach",Zo="has",Tr=["clear","delete"],jo=["get",Zo,"set"],en=Tr.concat(Cr,jo),Pr=Tr.concat(jo),tn=["add"].concat(Tr,Cr,Zo);var rn=Pe?Ne(en):E("Map");var on=Pe?Ne(Pr):E("WeakMap");var nn=Pe?Ne(tn):E("Set");var sn=E("WeakSet");function Q(e){for(var t=w(e),n=t.length,i=Array(n),a=0;a<n;a++)i[a]=e[t[a]];return i}function Mr(e){for(var t=w(e),n=t.length,i=Array(n),a=0;a<n;a++)i[a]=[t[a],e[t[a]]];return i}function ot(e){for(var t={},n=w(e),i=0,a=n.length;i<a;i++)t[e[n[i]]]=n[i];return t}function $e(e){var t=[];for(var n in e)q(e[n])&&t.push(n);return t.sort()}function ve(e,t){return function(n){var i=arguments.length;if(t&&(n=Object(n)),i<2||n==null)return n;for(var a=1;a<i;a++)for(var s=arguments[a],f=e(s),l=f.length,h=0;h<l;h++){var p=f[h];(!t||n[p]===void 0)&&(n[p]=s[p])}return n}}var Lt=ve(Z);var _e=ve(w);var Bt=ve(Z,!0);function Ni(){return function(){}}function nt(e){if(!L(e))return{};if(vr)return vr(e);var t=Ni();t.prototype=e;var n=new t;return t.prototype=null,n}function Nr(e,t){var n=nt(e);return t&&_e(n,t),n}function $r(e){return L(e)?V(e)?e.slice():Lt({},e):e}function Dr(e,t){return t(e),e}function Ht(e){return V(e)?e:[e]}y.toPath=Ht;function j(e){return y.toPath(e)}function we(e,t){for(var n=t.length,i=0;i<n;i++){if(e==null)return;e=e[t[i]]}return n?e:void 0}function it(e,t,n){var i=we(e,j(t));return Ge(i)?n:i}function Lr(e,t){t=j(t);for(var n=t.length,i=0;i<n;i++){var a=t[i];if(!N(e,a))return!1;e=e[a]}return!!n}function Ae(e){return e}function oe(e){return e=_e({},e),function(t){return rt(t,e)}}function Ee(e){return e=j(e),function(t){return we(t,e)}}function ee(e,t,n){if(t===void 0)return e;switch(n??3){case 1:return function(i){return e.call(t,i)};case 3:return function(i,a,s){return e.call(t,i,a,s)};case 4:return function(i,a,s,f){return e.call(t,i,a,s,f)}}return function(){return e.apply(t,arguments)}}function st(e,t,n){return e==null?Ae:q(e)?ee(e,t,n):L(e)&&!V(e)?oe(e):Ee(e)}function De(e,t){return st(e,t,1/0)}y.iteratee=De;function O(e,t,n){return y.iteratee!==De?y.iteratee(e,t):st(e,t,n)}function Br(e,t,n){t=O(t,n);for(var i=w(e),a=i.length,s={},f=0;f<a;f++){var l=i[f];s[l]=t(e[l],l,e)}return s}function at(){}function Hr(e){return e==null?at:function(t){return it(e,t)}}function zr(e,t,n){var i=Array(Math.max(0,e));t=ee(t,n,1);for(var a=0;a<e;a++)i[a]=t(a);return i}function Le(e,t){return t==null&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))}var ue=Date.now||function(){return new Date().getTime()};function ft(e){var t=function(s){return e[s]},n="(?:"+w(e).join("|")+")",i=RegExp(n),a=RegExp(n,"g");return function(s){return s=s==null?"":""+s,i.test(s)?s.replace(a,t):s}}var zt={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"};var an=ft(zt);var un=ot(zt);var ln=ft(un);var cn=y.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var kr=/(.)^/,$i={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},Di=/\\|'|\r|\n|\u2028|\u2029/g;function Li(e){return"\\"+$i[e]}var Bi=/^\s*(\w|\$)+\s*$/;function Ir(e,t,n){!t&&n&&(t=n),t=Bt({},t,y.templateSettings);var i=RegExp([(t.escape||kr).source,(t.interpolate||kr).source,(t.evaluate||kr).source].join("|")+"|$","g"),a=0,s="__p+='";e.replace(i,function(p,R,b,_,d){return s+=e.slice(a,d).replace(Di,Li),a=d+p.length,R?s+=`'+
((__t=(`+R+`))==null?'':_.escape(__t))+
'`:b?s+=`'+
((__t=(`+b+`))==null?'':__t)+
'`:_&&(s+=`';
`+_+`
__p+='`),p}),s+=`';
`;var f=t.variable;if(f){if(!Bi.test(f))throw new Error("variable is not a bare identifier: "+f)}else s=`with(obj||{}){
`+s+`}
`,f="obj";s=`var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};
`+s+`return __p;
`;var l;try{l=new Function(f,"_",s)}catch(p){throw p.source=s,p}var h=function(p){return l.call(this,p,y)};return h.source="function("+f+`){
`+s+"}",h}function Vr(e,t,n){t=j(t);var i=t.length;if(!i)return q(n)?n.call(e):n;for(var a=0;a<i;a++){var s=e?.[t[a]];s===void 0&&(s=n,a=i),e=q(s)?s.call(e):s}return e}var Hi=0;function Ur(e){var t=++Hi+"";return e?e+t:t}function Xr(e){var t=y(e);return t._chain=!0,t}function ut(e,t,n,i,a){if(!(i instanceof t))return e.apply(n,a);var s=nt(e.prototype),f=e.apply(s,a);return L(f)?f:s}var Qr=F(function(e,t){var n=Qr.placeholder,i=function(){for(var a=0,s=t.length,f=Array(s),l=0;l<s;l++)f[l]=t[l]===n?arguments[a++]:t[l];for(;a<arguments.length;)f.push(arguments[a++]);return ut(e,i,this,this,f)};return i});Qr.placeholder=y;var le=Qr;var kt=F(function(e,t,n){if(!q(e))throw new TypeError("Bind must be called on a function");var i=F(function(a){return ut(e,i,t,this,n.concat(a))});return i});var T=je(C);function U(e,t,n,i){if(i=i||[],!t&&t!==0)t=1/0;else if(t<=0)return i.concat(e);for(var a=i.length,s=0,f=C(e);s<f;s++){var l=e[s];if(T(l)&&(V(l)||Me(l)))if(t>1)U(l,t-1,n,i),a=i.length;else for(var h=0,p=l.length;h<p;)i[a++]=l[h++];else n||(i[a++]=l)}return i}var pn=F(function(e,t){t=U(t,!1,!1);var n=t.length;if(n<1)throw new Error("bindAll must be passed function names");for(;n--;){var i=t[n];e[i]=kt(e[i],e)}return e});function Wr(e,t){var n=function(i){var a=n.cache,s=""+(t?t.apply(this,arguments):i);return N(a,s)||(a[s]=e.apply(this,arguments)),a[s]};return n.cache={},n}var It=F(function(e,t,n){return setTimeout(function(){return e.apply(null,n)},t)});var mn=le(It,y,1);function Jr(e,t,n){var i,a,s,f,l=0;n||(n={});var h=function(){l=n.leading===!1?0:ue(),i=null,f=e.apply(a,s),i||(a=s=null)},p=function(){var R=ue();!l&&n.leading===!1&&(l=R);var b=t-(R-l);return a=this,s=arguments,b<=0||b>t?(i&&(clearTimeout(i),i=null),l=R,f=e.apply(a,s),i||(a=s=null)):!i&&n.trailing!==!1&&(i=setTimeout(h,b)),f};return p.cancel=function(){clearTimeout(i),l=0,i=a=s=null},p}function Gr(e,t,n){var i,a,s,f,l,h=function(){var R=ue()-a;t>R?i=setTimeout(h,t-R):(i=null,n||(f=e.apply(l,s)),i||(s=l=null))},p=F(function(R){return l=this,s=R,a=ue(),i||(i=setTimeout(h,t),n&&(f=e.apply(l,s))),f});return p.cancel=function(){clearTimeout(i),i=s=l=null},p}function Kr(e,t){return le(t,e)}function Re(e){return function(){return!e.apply(this,arguments)}}function Yr(){var e=arguments,t=e.length-1;return function(){for(var n=t,i=e[t].apply(this,arguments);n--;)i=e[n].call(this,i);return i}}function Zr(e,t){return function(){if(--e<1)return t.apply(this,arguments)}}function lt(e,t){var n;return function(){return--e>0&&(n=t.apply(this,arguments)),e<=1&&(t=null),n}}var dn=le(lt,2);function ct(e,t,n){t=O(t,n);for(var i=w(e),a,s=0,f=i.length;s<f;s++)if(a=i[s],t(e[a],a,e))return a}function pt(e){return function(t,n,i){n=O(n,i);for(var a=C(t),s=e>0?0:a-1;s>=0&&s<a;s+=e)if(n(t[s],s,t))return s;return-1}}var Be=pt(1);var Vt=pt(-1);function mt(e,t,n,i){n=O(n,i,1);for(var a=n(t),s=0,f=C(e);s<f;){var l=Math.floor((s+f)/2);n(e[l])<a?s=l+1:f=l}return s}function dt(e,t,n){return function(i,a,s){var f=0,l=C(i);if(typeof s=="number")e>0?f=s>=0?s:Math.max(s+l,f):l=s>=0?Math.min(s+1,l):s+l+1;else if(n&&s&&l)return s=n(i,a),i[s]===a?s:-1;if(a!==a)return s=t(re.call(i,f,l),Ye),s>=0?s+f:-1;for(s=e>0?f:l-1;s>=0&&s<l;s+=e)if(i[s]===a)return s;return-1}}var Ut=dt(1,Be,mt);var hn=dt(-1,Vt);function He(e,t,n){var i=T(e)?Be:ct,a=i(e,t,n);if(a!==void 0&&a!==-1)return e[a]}function jr(e,t){return He(e,oe(t))}function $(e,t,n){t=ee(t,n);var i,a;if(T(e))for(i=0,a=e.length;i<a;i++)t(e[i],i,e);else{var s=w(e);for(i=0,a=s.length;i<a;i++)t(e[s[i]],s[i],e)}return e}function X(e,t,n){t=O(t,n);for(var i=!T(e)&&w(e),a=(i||e).length,s=Array(a),f=0;f<a;f++){var l=i?i[f]:f;s[f]=t(e[l],l,e)}return s}function ht(e){var t=function(n,i,a,s){var f=!T(n)&&w(n),l=(f||n).length,h=e>0?0:l-1;for(s||(a=n[f?f[h]:h],h+=e);h>=0&&h<l;h+=e){var p=f?f[h]:h;a=i(a,n[p],p,n)}return a};return function(n,i,a,s){var f=arguments.length>=3;return t(n,ee(i,s,4),a,f)}}var Xt=ht(1);var eo=ht(-1);function Y(e,t,n){var i=[];return t=O(t,n),$(e,function(a,s,f){t(a,s,f)&&i.push(a)}),i}function to(e,t,n){return Y(e,Re(O(t)),n)}function Qt(e,t,n){t=O(t,n);for(var i=!T(e)&&w(e),a=(i||e).length,s=0;s<a;s++){var f=i?i[s]:s;if(!t(e[f],f,e))return!1}return!0}function Wt(e,t,n){t=O(t,n);for(var i=!T(e)&&w(e),a=(i||e).length,s=0;s<a;s++){var f=i?i[s]:s;if(t(e[f],f,e))return!0}return!1}function B(e,t,n,i){return T(e)||(e=Q(e)),(typeof n!="number"||i)&&(n=0),Ut(e,t,n)>=0}var gn=F(function(e,t,n){var i,a;return q(t)?a=t:(t=j(t),i=t.slice(0,-1),t=t[t.length-1]),X(e,function(s){var f=a;if(!f){if(i&&i.length&&(s=we(s,i)),s==null)return;f=s[t]}return f==null?f:f.apply(s,n)})});function Oe(e,t){return X(e,Ee(t))}function ro(e,t){return Y(e,oe(t))}function gt(e,t,n){var i=-1/0,a=-1/0,s,f;if(t==null||typeof t=="number"&&typeof e[0]!="object"&&e!=null){e=T(e)?e:Q(e);for(var l=0,h=e.length;l<h;l++)s=e[l],s!=null&&s>i&&(i=s)}else t=O(t,n),$(e,function(p,R,b){f=t(p,R,b),(f>a||f===-1/0&&i===-1/0)&&(i=p,a=f)});return i}function oo(e,t,n){var i=1/0,a=1/0,s,f;if(t==null||typeof t=="number"&&typeof e[0]!="object"&&e!=null){e=T(e)?e:Q(e);for(var l=0,h=e.length;l<h;l++)s=e[l],s!=null&&s<i&&(i=s)}else t=O(t,n),$(e,function(p,R,b){f=t(p,R,b),(f<a||f===1/0&&i===1/0)&&(i=p,a=f)});return i}var zi=/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g;function xt(e){return e?V(e)?re.call(e):Te(e)?e.match(zi):T(e)?X(e,Ae):Q(e):[]}function yt(e,t,n){if(t==null||n)return T(e)||(e=Q(e)),e[Le(e.length-1)];var i=xt(e),a=C(i);t=Math.max(Math.min(t,a),0);for(var s=a-1,f=0;f<t;f++){var l=Le(f,s),h=i[f];i[f]=i[l],i[l]=h}return i.slice(0,t)}function no(e){return yt(e,1/0)}function io(e,t,n){var i=0;return t=O(t,n),Oe(X(e,function(a,s,f){return{value:a,index:i++,criteria:t(a,s,f)}}).sort(function(a,s){var f=a.criteria,l=s.criteria;if(f!==l){if(f>l||f===void 0)return 1;if(f<l||l===void 0)return-1}return a.index-s.index}),"value")}function se(e,t){return function(n,i,a){var s=t?[[],[]]:{};return i=O(i,a),$(n,function(f,l){var h=i(f,l,n);e(s,f,h)}),s}}var xn=se(function(e,t,n){N(e,n)?e[n].push(t):e[n]=[t]});var yn=se(function(e,t,n){e[n]=t});var vn=se(function(e,t,n){N(e,n)?e[n]++:e[n]=1});var _n=se(function(e,t,n){e[n?0:1].push(t)},!0);function so(e){return e==null?0:T(e)?e.length:w(e).length}function ao(e,t,n){return t in n}var Jt=F(function(e,t){var n={},i=t[0];if(e==null)return n;q(i)?(t.length>1&&(i=ee(i,t[1])),t=Z(e)):(i=ao,t=U(t,!1,!1),e=Object(e));for(var a=0,s=t.length;a<s;a++){var f=t[a],l=e[f];i(l,f,e)&&(n[f]=l)}return n});var wn=F(function(e,t){var n=t[0],i;return q(n)?(n=Re(n),t.length>1&&(i=t[1])):(t=X(U(t,!1,!1),String),n=function(a,s){return!B(t,s)}),Jt(e,n,i)});function vt(e,t,n){return re.call(e,0,Math.max(0,e.length-(t==null||n?1:t)))}function _t(e,t,n){return e==null||e.length<1?t==null||n?void 0:[]:t==null||n?e[0]:vt(e,e.length-t)}function be(e,t,n){return re.call(e,t==null||n?1:t)}function fo(e,t,n){return e==null||e.length<1?t==null||n?void 0:[]:t==null||n?e[e.length-1]:be(e,Math.max(0,e.length-t))}function uo(e){return Y(e,Boolean)}function lo(e,t){return U(e,t,!1)}var Gt=F(function(e,t){return t=U(t,!0,!0),Y(e,function(n){return!B(t,n)})});var An=F(function(e,t){return Gt(e,t)});function ze(e,t,n,i){Ke(t)||(i=n,n=t,t=!1),n!=null&&(n=O(n,i));for(var a=[],s=[],f=0,l=C(e);f<l;f++){var h=e[f],p=n?n(h,f,e):h;t&&!n?((!f||s!==p)&&a.push(h),s=p):n?B(s,p)||(s.push(p),a.push(h)):B(a,h)||a.push(h)}return a}var En=F(function(e){return ze(U(e,!0,!0))});function co(e){for(var t=[],n=arguments.length,i=0,a=C(e);i<a;i++){var s=e[i];if(!B(t,s)){var f;for(f=1;f<n&&B(arguments[f],s);f++);f===n&&t.push(s)}}return t}function ke(e){for(var t=e&&gt(e,C).length||0,n=Array(t),i=0;i<t;i++)n[i]=Oe(e,i);return n}var Rn=F(ke);function po(e,t){for(var n={},i=0,a=C(e);i<a;i++)t?n[e[i]]=t[i]:n[e[i][0]]=e[i][1];return n}function mo(e,t,n){t==null&&(t=e||0,e=0),n||(n=t<e?-1:1);for(var i=Math.max(Math.ceil((t-e)/n),0),a=Array(i),s=0;s<i;s++,e+=n)a[s]=e;return a}function ho(e,t){if(t==null||t<1)return[];for(var n=[],i=0,a=e.length;i<a;)n.push(re.call(e,i,i+=t));return n}function Ie(e,t){return e._chain?y(t).chain():t}function wt(e){return $($e(e),function(t){var n=y[t]=e[t];y.prototype[t]=function(){var i=[this._wrapped];return Bo.apply(i,arguments),Ie(this,n.apply(y,i))}}),y}$(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=Je[e];y.prototype[e]=function(){var n=this._wrapped;return n!=null&&(t.apply(n,arguments),(e==="shift"||e==="splice")&&n.length===0&&delete n[0]),Ie(this,n)}});$(["concat","join","slice"],function(e){var t=Je[e];y.prototype[e]=function(){var n=this._wrapped;return n!=null&&(n=t.apply(n,arguments)),Ie(this,n)}});var On=y;var xo=wt(go);xo._=xo;var v=xo;var ki=function(e){return!e||K(e)?e:JSON.parse(JSON.stringify(e))},H=ki;var Ii=["start","count","end","page","index_limit","total_pages","total_available","page_limit"],Kt=Ii;var bn=function(e){this.set=function(n){let i=Object.keys(n);if(["index_limit","total_pages"].forEach(s=>{if(i.includes(s))throw new Error(`Can not set ${s} (it is a calculated value)`)}),i.includes("start")&&i.includes("end")&&i.includes("count"))throw new Error("Can not set start, end and count all at the same time");if(i.includes("page")&&(i.includes("start")||i.includes("end")))throw new Error("Can not set page as well as the start and/or end");if(i.forEach(s=>{s!=="end"&&(t[s]=n[s])}),i.includes("page")&&(t.start=t.count*(t.page-1)),i.includes("end")){if(t.start>=n.end)throw new Error("The start value can not be greater than the end value");i.includes("count")?t.start=Math.max(0,n.end-(t.count-1)):t.count=n.end-t.start+1,t.end=n.end}else{let s=t.start+t.count-1;t.end=s<t.start?t.end:s}typeof t.total_available=="number"&&t.total_available>0&&(t.index_limit=t.total_available-1),t.count>0&&t.start%t.count===0&&(t.page=Math.floor(t.start/t.count)+1,typeof t.total_available=="number"&&(t.total_pages=Math.ceil(t.total_available/t.count),t.page_limit=t.total_pages));let a=Object.keys(t);if(!a.includes("start")||!a.includes("count"))throw new Error("Not enough information given to create Paginator");return this},this.get=function(n){return t[n]};let t={count:0,end:0,index_limit:1/0,page:0,page_limit:1/0,start:0,total_available:void 0,total_pages:void 0};this.set(e)};bn.getPossibleKeys=Kt;var Ve=bn;var Fn=function(e,t){this.start=Math.max(Math.min(e,t),0),this.end=Math.max(Math.max(e,t),0),this.inSection=function(n){return n>=this.start&&n<=this.end},this.overlaps=function(n){return this.inSection(n.start)||this.inSection(n.end)},this.calcLength=function(){return this.end-this.start+1},this.shifted=function(n,i){return typeof i!="number"&&(i=n),new Fn(this.start+n,this.end+i)},this.expanded=function(n){return this.shifted(-1*n,n)}},ce=Fn;var qn=function(e){let t=new Ve({start:e.start,count:e.count}),n=Ve.getPossibleKeys;e=H(e),n.forEach(i=>{delete e[i]}),e.request_id=e.request_id||0,this.get=function(i){return Ve.getPossibleKeys.includes(i)?t.get(i):e[i]},this.set=function(i){let[a,s]=[{...i},{...i}];return n.forEach(f=>{Object.keys(i).includes(f)?delete s[f]:delete a[f]}),Object.keys(s).length>0&&(t.set({total_available:void 0}),typeof s.request_id!="number"&&(e.request_id+=1)),t.set(a),e={...e,...s},this},this.clone=function(){let i=H(e);return i.start=t.get("start"),i.count=t.get("count"),new qn(i)},this.toSection=function(){return new ce(this.get("start"),this.get("end"))},this.toLimitSection=function(){return new ce(this.get("start"),this.get("index_limit"))},this.toJSON=function(){return{uid:this.get("uid"),request_id:this.get("request_id"),start:this.get("start"),count:this.get("count"),field_tree:this.get("field_tree"),facets:this.get("facets"),sort:this.get("sort"),settings:this.get("settings"),raw_query:this.get("raw_query")}}},Yt=qn;var Vi={cache_size:{},connection_attempts:3,datastores_url:"",default_cache_size:20,init_attempts:3,message_formats:{failed_init:"Failed to initialize Pride",failed_record_load:"Failed to load $1",failed_search_run:"Failed to search $1"},ms_between_attempts:1500,obnoxious:!1},D=Vi;var Ui=function(e,t){if(D.obnoxious){let n=G(arguments,2);n.unshift(`[Pride: ${e}] ${t}`),console.log.apply(console,n)}},W=Ui;var Xi=function(e){return K(e)?e.apply(this,G(arguments,1)):e},P=Xi;var Qi=function(e,t){return K(e)?e.apply(this,t):e},Ue=Qi;var Wi=function(e){let t={};this.clear=i=>(delete t[i],this),this.clearAll=()=>(t={},this);let n=i=>(t&&hasOwnProperty.call(t,i)||(t[i]=[]),t[i]);this.add=(i,a)=>(n(a).push(i),this),this.remove=(i,a)=>(t[a]=n(a).filter(s=>i!==s),this),this.apply=(i,a)=>(n(i).forEach(s=>{Ue(s,a)}),this),this.call=(i,...a)=>(this.apply(i,a),this),K(e)&&e.call(this)},ne=Wi;var Ji=new ne(function(){this.addObserver=this.add,this.removeObserver=this.remove,this.clearObservers=this.clear,this.add=this.remove=this.clear=void 0,this.sendMessage=e=>(e.summary&&(e.class=e.class||"info",e.details=e.details||"",this.call(e.class,e),W("Messenger","MESSAGE SENT",e)),this),this.sendMessageArray=e=>(e&&e.length>0&&e.forEach(t=>{this.sendMessage(t)}),this),this.preset=function(e){}}),z=Ji;var Gi=function(e,t){this.datastore=e.datastore,this.query=e.query||this.datastore.baseQuery();let n=this,i=e.requestFunc||this.datastore.runQuery,a=e.starting_results||[],s=e.cache_size||D.cache_size[this.datastore.uid]||D.default_cache_size;this.log=function(){let d=G(arguments);d.unshift("Search ("+n.datastore.get("uid")+")"),W.apply(window,d)},this.set=function(d){return n.query.set(d),P(n.setDataChanged),v.isEmpty(v.omit(d,Kt))||(a=[]),n},this.run=function(d){return P(n.resultsChanged),v.isUndefined(d)&&(d=s),f(p(n.query.toSection().expanded(d))),n},this.results=function(){return R(new ce(n.query.get("start"),Math.min(n.query.get("end"),n.query.get("index_limit"))))};let f=function(d){if(n.log("REQUESTING",d),n.log("TOTAL AVAILABLE (pre-request)",n.query.get("total_available")),d&&n.query.toLimitSection().overlaps(d)){n.log("Sending query...");let x=n.query.clone().set({start:d.start,count:d.calcLength()});i({query:x,failure_message:z.preset("failed_search_run",n.datastore.get("metadata").name),success:function(S){if(S.request.request_id===n.query.get("request_id")){h(S),l(S.response,x.get("start"));let J=S.response.length;J!==0&&J<x.get("count")&&f(d.shifted(J,0))}}})}else P(n.runDataChanged)},l=function(d,x){let S=!1;n.log("NEW RECORDS",d),v.each(d,function(J,Qe){let he=Qe+x;v.isUndefined(a[he])&&(a[he]=P(n.createItem,J),n.query.toSection().inSection(he)&&(S=!0))}),n.log("CACHE LENGTH",a.length),(S||v.isEmpty(d))&&P(n.resultsChanged)},h=function(d){n.datastore.update(d.datastore);let x=v.omit(d.new_request,"start","count");x.specialists=d.specialists,x.total_available=d.total_available,n.query.set(x),P(n.runDataChanged)},p=function(d){let x=R(d),S=v.indexOf(x,void 0);if(S!==-1){let J=d.start+v.lastIndexOf(x,void 0);return S+=d.start,new ce(S,J)}},R=function(d){let x=[];for(let S=d.start;S<=d.end;S++)x.push(a[S]);return x},b=!1,_=[];this.mutableObservables=[],this.getMute=function(){return b},this.setMute=function(d){return d!==b&&(b=d,b||v.each(n.mutableObservables,function(x){x.notify()})),n},this.createObservable=function(d,x,S){let J=new ne(function(){let Qe=this.add,he=this.call;_.push(this),S||n.mutableObservables.push(this),this.add=function(ge){return(!n.muted||S)&&ge(x()),Qe(ge,"observers"),this},this.notify=function(){if(!n.muted||S){let ge=x();n.log("NOTIFY ("+d+")",ge),he("observers",ge)}return this}});return n[d+"Changed"]=J.notify,t[d+"Observers"]=J,n},this.createObservable("mute",this.getMute,!0).createObservable("setData",function(){t.getData()}).createObservable("runData",function(){t.getData()}).createObservable("results",this.results),t.set=function(d){return n.set(d),t},t.run=function(d){return n.run(d),t},t.nextPage=function(d){let x=n.query.get("page");return v.isNumber(x)&&x<n.query.get("page_limit")&&(t.set({page:x+1}),t.run(d)),t},t.prevPage=function(d){let x=n.query.get("page");return v.isNumber(x)&&x>1&&(t.set({page:x-1}),t.run(d)),t}},Zt=Gi;var Tn=wi(Cn());var Pn=function(e){if(W("Request","Sending HTTP request..."),W("Request","URL",e.url),W("Request","CONTENT",JSON.stringify(e.query)),!e.url)throw new Error("No URL given to Pride.Util.request()");let t="get";e.query&&(t="post"),v.isNumber(e.attempts)||(e.attempts=D.connection_attempts),e.attempts-=1,(0,Tn.default)({url:e.url,data:JSON.stringify(e.query),type:"json",method:t,contentType:"application/json",withCredentials:!0,error:function(n){e.attempts<=0?(W("Request","ERROR",n),P(e.failure,n),z.sendMessage({summary:e.failure_message,class:"error"})):(W("Request","Trying request again..."),window.setTimeout(function(){Pn(e)},D.ms_between_attempts))},success:function(n){W("Request","SUCCESS",n),P(e.success,n),z.sendMessage({summary:e.success_message,class:"success"}),z.sendMessageArray(n.messages)}})},pe=Pn;var Ki=function(e){e=e||{};let t=new ne,n=!1,i=!1,a=!1,s;this.request=function(p){return t.add(p.success,"success").add(p.failure,"failure"),n?f():l(),this};let f=function(p){s=p||s,i?h("success"):a&&h("failure")},l=function(){n=!0,pe({url:P(e.url),attempts:P(e.attempts)||D.connection_attempts,failure_message:P(e.failure_message),failure:function(p){a=!0,P(e.before_failure,p),f(p),P(e.after_failure,p)},success:function(p){i=!0,P(e.before_success,p),v.isFunction(e.edit_response)&&(p=e.edit_response(p)),f(p),P(e.after_success,p)}})},h=function(p){t.call(p,s).clearAll()}},me=Ki;var Yi=function(e){let t=function(i){let a=i.fields.find(s=>s.uid==="resource_access");return a?.value?a.value:a},n=function(i){return[t(e)].concat(i)};this.getData=function(i){P(i,n(e.holdings))}},At=Yi;var Zi=function(e,t){this.barcode=e,this.data=t;let n=function(s){let f;return v.each(s.fields,function(l){l.uid==="get_this_url"&&(f=l.value)}),f},i=new me({url:n(t)+"/"+this.barcode,failure_message:z.preset("failed_get_this_load",t.names[0]),edit_response:function(s){return t=a(s),t}}),a=function(s){return s};this.getData=function(s){i.request({success:s})}},Et=Zi;var ji=function(e){let t=document.createElement("div");return t.appendChild(document.createTextNode(e)),t.innerHTML},Rt=ji;var es={selectedRecords:null,engine:null,updateSelectedRecords:function(e){return this.selectedRecords=this.selectedRecords||{mirlyn:{},articlesplus:{},databases:{},journals:{},website:{}},Array.isArray(e)?(e.forEach(t=>{this.selectedRecords[t.datastore]={},this.selectedRecords[t.datastore][t.uid]=!0}),this):(Object.keys(e).forEach(t=>{this.selectedRecords[t]={},e[t].forEach(n=>{this.selectedRecords[t][n.uid]=!0})}),this)},registerEngine:function(e){return e?(this.engine=e,this.updateSelectedRecords(this.engine.listRecords()),this.engine.addObserver(()=>t=>{this.updateSelectedRecords(t)}),this):this},selected:function(e){return this.engine?(this.selectedRecords[e.datastore]||{})[e.uid]:!1}},jt=es;var ts=function(e){let t=new me({url:e.source,failure_message:z.preset("failed_record_load",e.names[0]),edit_response:function(f){return e=s(f),e}}),n=null,i={};this.placeHold=function(f,l,h,p){this.renderFull(function(R){let _=pe({url:[function(){let d;return v.each(R.fields,function(x){x.uid==="holdings_url"&&(d=x.value)}),d}(),f,l,h].join("/"),query:!0,failure:function(d){z.sendMessage({summary:"Failed to place hold",class:"error"})},success:p,failure_message:"placeHold failed",success_message:"placeHold succeeded"});console.log(_)})},this.getHoldings=function(f){n?n.getData(f):e.complete?(n=new At(e),n.getData(f)):t.request({success:function(l){n=new At(l),n.getData(f)}})},this.getGetThis=function(f,l){i[f]?i[f].getData(l):e.complete?(i[f]=new Et(f,e),i[f].getData(l)):t.request({success:function(h){i[f]=new Et(f,h),i[f].getData(l)}})},this.renderPart=function(f){a(f)},this.renderPartThenCache=function(f){a(f),t.request()},this.renderFull=function(f){e.complete?a(f):t.request({success:f})},this.renderCSL=function(f){this.renderFull(function(l){let h;v.each(l.fields,function(p){p.uid==="csl"&&(h=p.value)}),f(h)})};let a=function(f){f(v.omit(e,"complete","source"),e.complete)},s=function(f){return f.fields=v.map(f.fields,function(l){return l.value_has_html||(l.value=Rt(l.value)),v.omit(l,"value_has_html")}),f.names_have_html||(f.names=v.map(f.names,function(l){return Rt(l)})),f.uid?f.status=200:f.status=404,jt.selected(f)&&(f.selected=!0),v.omit(f,"names_have_html")};e=s(e)},Xe=ts;var rs=function(e){this.uid=e.data.uid,this.getData=()=>e.data,this.getResults=()=>e.results;let t=!1;this.getMute=()=>t,this.setMute=i=>(t=i,this),this.observables=[];let n=i=>{let a=this;return new ne(function(){a.observables.push(this);let f=this.add;this.add=function(l){return a.muted||l(i()),f(l,"observers"),this}})};this.resultsObservers=n(this.getResults),this.setDataObservers=this.runDataObservers=n(this.getData),this.clearAllObservers=()=>(this.observables.forEach(i=>{i.clearAll()}),this)},er=rs;var os=function(e){let t=this,n=new Zt(e,this);n.createItem=function(s){return new Xe(s)};let i=[],a=[];this.getFacets=function(){return i},this.uid=n.datastore.get("uid"),this.getData=function(){return{uid:t.uid,metadata:H(n.datastore.get("metadata")),sorts:H(n.datastore.get("sorts")),selected_sort:n.query.get("sort"),facets:H(n.query.get("facets")),fields:H(n.datastore.get("fields")),field_tree:H(n.query.get("field_tree")),settings:H(n.query.get("settings")),page:n.query.get("page"),count:n.query.get("count"),total_available:n.query.get("total_available"),total_pages:n.query.get("total_pages"),page_limit:n.query.get("page_limit"),specialists:H(n.query.get("specialists"))}},this.getResults=n.results,n.initialize_observables=function(){t.runDataObservers.add(function(){let s=n.datastore.get("facets");JSON.stringify(a)!==JSON.stringify(s)&&(v.each(i,function(f){f.clearAllObservers()}),i=v.map(s,function(f){return new er({data:v.omit(f,"values"),results:f.values})}),a=s,t.facetsObservers.notify())})},this.getMute=n.getMute,this.setMute=function(s){return v.each(i,function(f){f.setMute(s)}),n.setMute(s),t},n.createObservable("facets",this.getFacets).initialize_observables()},tr=os;var ns=Ce("field_boolean",["field_boolean","field"]),Ot=ns;var is=["value_boolean","literal","tag","special"],de=is;var ss=I("field",de,function(){this.serialize=function(){return`${this.value}: (${this.serializedChildren().join(" ")})`}}),rr=ss;var as=I("literal"),or=as;var fs=function(e){e=H(e),this.baseQuery=function(){return new Yt({uid:e.uid,sort:e.default_sort,start:0,count:0,settings:{},field_tree:t(),facets:v.reduce(e.facets,function(n,i){return i.required&&!i.fixed&&(n[i.uid]=i.default_value),n},{})})},this.baseSearch=function(){return new tr({datastore:this})},this.runQuery=function(n){return n.url=e.url,pe(n),this},this.get=function(n){return e[n]},this.update=function(n){v.extend(e,n)};let t=function(n){n=n||new Ot("AND");let i=v.reduce(e.fields,function(a,s){if((s.required||s.fixed)&&!a.contains({type:"field",value:s.uid})){let f=new rr(s.uid,new or(s.default_value));return v.isMatch(a,{type:"field_boolean",value:"AND"})?a.addChild(f):new Ot("AND",a,f)}return a},n);return i.matches({type:"field_boolean",children:[]})?{}:i}},nr=fs;var us={boolNodeFactory:Ce,Datastore:nr,DatastoreSearch:tr,FacetSearch:er,GetThis:Et,Holdings:At,log:W,nodeFactory:I,Query:Yt,Record:Xe,SearchBase:Zt},Mn=us;var ls=function(){"use strict";function e(i,a){function s(){this.constructor=i}s.prototype=a.prototype,i.prototype=new s}function t(i,a,s,f){this.message=i,this.expected=a,this.found=s,this.location=f,this.name="SyntaxError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,t)}e(t,Error),t.buildMessage=function(i,a){let s={literal:function(_){return'"'+l(_.text)+'"'},class:function(_){let d="",x;for(x=0;x<_.parts.length;x++)d+=_.parts[x]instanceof Array?h(_.parts[x][0])+"-"+h(_.parts[x][1]):h(_.parts[x]);return"["+(_.inverted?"^":"")+d+"]"},any:function(_){return"any character"},end:function(_){return"end of input"},other:function(_){return _.description}};function f(_){return _.charCodeAt(0).toString(16).toUpperCase()}function l(_){return _.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(d){return"\\x0"+f(d)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(d){return"\\x"+f(d)})}function h(_){return _.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(d){return"\\x0"+f(d)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(d){return"\\x"+f(d)})}function p(_){return s[_.type](_)}function R(_){let d=new Array(_.length),x,S;for(x=0;x<_.length;x++)d[x]=p(_[x]);if(d.sort(),d.length>0){for(x=1,S=1;x<d.length;x++)d[x-1]!==d[x]&&(d[S]=d[x],S++);d.length=S}switch(d.length){case 1:return d[0];case 2:return d[0]+" or "+d[1];default:return d.slice(0,-1).join(", ")+", or "+d[d.length-1]}}function b(_){return _?'"'+l(_)+'"':"end of input"}return"Expected "+R(i)+" but "+b(a)+" found."};function n(i,a){a=a!==void 0?a:{};let s={},f={start:bo},l=bo,h=function(u){return u},p=function(u,c,g){return new ae.FieldBoolean(c,u,g)},R=function(u,c){return c?[u,c]:u},b=function(u){return u},_=":",d=Fe(":",!1),x=function(u,c){return new ae.Field(u,c)},S=function(u){return new ae.Field(hi,u)},J=function(u){return u.join("")},Qe=function(u,c){return c?u.concat(c):u},he=function(u,c){return[new ae.Literal(u+c.join(""))]},ge=function(u){return[new ae.Literal(u.join(""))]},yo=function(u){return[new ae.Literal('"'+u.join("")+'"')]},Vn=function(u){return u},vo="AND",Un=Fe("AND",!1),_o="OR",Xn=Fe("OR",!1),wo="NOT",Qn=Fe("NOT",!1),Wn="'",Jn=Fe("'",!1),Gn=/^[^']/,Kn=qe(["'"],!0,!1),Yn='"',Zn=Fe('"',!1),jn=/^[^"]/,ei=qe(['"'],!0,!1),ti=/^[^ \t\r\n:'"()]/,ri=qe([" ","	","\r",`
`,":","'",'"',"(",")"],!0,!1),oi=/^[^ \t\r\n():]/,ni=qe([" ","	","\r",`
`,"(",")",":"],!0,!1),ii=/^[^ \t\r\n'"():]/,si=qe([" ","	","\r",`
`,"'",'"',"(",")",":"],!0,!1),Ao=/^[ \t\r\n]/,Eo=qe([" ","	","\r",`
`],!1,!1),m=0,bt=[{line:1,column:1}],te=0,fr=[],M=0;if("startRule"in a){if(!(a.startRule in f))throw new Error(`Can't start parsing from rule "`+a.startRule+'".');l=f[a.startRule]}function Fe(u,c){return{type:"literal",text:u,ignoreCase:c}}function qe(u,c,g){return{type:"class",parts:u,inverted:c,ignoreCase:g}}function ai(){return{type:"end"}}function Ro(u){let c=bt[u],g;if(c)return c;for(g=u-1;!bt[g];)g--;for(c=bt[g],c={line:c.line,column:c.column};g<u;)i.charCodeAt(g)===10?(c.line++,c.column=1):c.column++,g++;return bt[u]=c,c}function Oo(u,c){let g=Ro(u),A=Ro(c);return{start:{offset:u,line:g.line,column:g.column},end:{offset:c,line:A.line,column:A.column}}}function k(u){m<te||(m>te&&(te=m,fr=[]),fr.push(u))}function fi(u,c,g){return new t(t.buildMessage(u,c),u,c,g)}function bo(){let u,c,g;return u=m,c=Fo(),c!==s?(g=di(),g!==s?(c=h(c),u=c):(m=u,u=s)):(m=u,u=s),u}function Fo(){let u,c,g,A,fe,dr;return u=m,c=ur(),c!==s?(g=We(),g!==s?(A=mi(),A!==s?(fe=We(),fe!==s?(dr=Fo(),dr!==s?(c=p(c,A,dr),u=c):(m=u,u=s)):(m=u,u=s)):(m=u,u=s)):(m=u,u=s)):(m=u,u=s),u===s&&(u=qo()),u}function qo(){let u,c,g;return u=ur(),u===s&&(u=m,c=ur(),c!==s?(g=ui(),g===s&&(g=null),g!==s?(c=R(c,g),u=c):(m=u,u=s)):(m=u,u=s)),u}function ui(){let u,c,g;return u=m,c=We(),c!==s?(g=qo(),g!==s?(c=b(g),u=c):(m=u,u=s)):(m=u,u=s),u}function ur(){let u,c,g,A;return u=m,c=li(),c!==s?(i.charCodeAt(m)===58?(g=_,m++):(g=s,M===0&&k(d)),g!==s?(A=lr(),A!==s?(c=x(c,A),u=c):(m=u,u=s)):(m=u,u=s)):(m=u,u=s),u===s&&(u=m,c=lr(),c!==s&&(c=S(c)),u=c),u}function li(){let u,c,g;if(u=m,c=[],g=Mo(),g!==s)for(;g!==s;)c.push(g),g=Mo();else c=s;return c!==s&&(c=J(c)),u=c,u}function lr(){let u,c,g;return u=m,c=pi(),c!==s?(g=ci(),g===s&&(g=null),g!==s?(c=Qe(c,g),u=c):(m=u,u=s)):(m=u,u=s),u}function ci(){let u,c,g;return u=m,c=We(),c!==s?(g=lr(),g!==s?(c=b(g),u=c):(m=u,u=s)):(m=u,u=s),u}function pi(){let u,c,g,A,fe;if(u=m,c=m,M++,g=cr(),M--,g===s?c=void 0:(m=c,c=s),c!==s)if(g=pr(),g!==s){if(A=[],fe=No(),fe!==s)for(;fe!==s;)A.push(fe),fe=No();else A=s;A!==s?(c=he(g,A),u=c):(m=u,u=s)}else m=u,u=s;else m=u,u=s;if(u===s){if(u=m,c=m,M++,g=cr(),M--,g===s?c=void 0:(m=c,c=s),c!==s){if(g=[],A=pr(),A!==s)for(;A!==s;)g.push(A),A=pr();else g=s;g!==s?(c=ge(g),u=c):(m=u,u=s)}else m=u,u=s;if(u===s){if(u=m,c=So(),c!==s){for(g=[],A=Co();A!==s;)g.push(A),A=Co();g!==s?(A=So(),A!==s?(c=yo(g),u=c):(m=u,u=s)):(m=u,u=s)}else m=u,u=s;if(u===s)if(u=m,c=To(),c!==s){for(g=[],A=Po();A!==s;)g.push(A),A=Po();g!==s?(A=To(),A!==s?(c=yo(g),u=c):(m=u,u=s)):(m=u,u=s)}else m=u,u=s}}return u}function mi(){let u,c;return u=m,c=cr(),c!==s&&(c=Vn(c)),u=c,u}function cr(){let u;return i.substr(m,3)===vo?(u=vo,m+=3):(u=s,M===0&&k(Un)),u===s&&(i.substr(m,2)===_o?(u=_o,m+=2):(u=s,M===0&&k(Xn)),u===s&&(i.substr(m,3)===wo?(u=wo,m+=3):(u=s,M===0&&k(Qn)))),u}function So(){let u;return i.charCodeAt(m)===39?(u=Wn,m++):(u=s,M===0&&k(Jn)),u}function Co(){let u;return Gn.test(i.charAt(m))?(u=i.charAt(m),m++):(u=s,M===0&&k(Kn)),u}function To(){let u;return i.charCodeAt(m)===34?(u=Yn,m++):(u=s,M===0&&k(Zn)),u}function Po(){let u;return jn.test(i.charAt(m))?(u=i.charAt(m),m++):(u=s,M===0&&k(ei)),u}function Mo(){let u;return ti.test(i.charAt(m))?(u=i.charAt(m),m++):(u=s,M===0&&k(ri)),u}function No(){let u;return oi.test(i.charAt(m))?(u=i.charAt(m),m++):(u=s,M===0&&k(ni)),u}function pr(){let u;return ii.test(i.charAt(m))?(u=i.charAt(m),m++):(u=s,M===0&&k(si)),u}function We(){let u,c;if(u=[],Ao.test(i.charAt(m))?(c=i.charAt(m),m++):(c=s,M===0&&k(Eo)),c!==s)for(;c!==s;)u.push(c),Ao.test(i.charAt(m))?(c=i.charAt(m),m++):(c=s,M===0&&k(Eo));else u=s;return u}function di(){let u;return u=We(),u===s&&(u=null),u}let hi=a.defaultFieldName||"all_fields",mr=l();if(mr!==s&&m===i.length)return mr;throw mr!==s&&m<i.length&&k(ai()),fi(fr,te<i.length?i.charAt(te):null,te<i.length?Oo(te,te+1):Oo(te,te))}return{SyntaxError:t,parse:n}}(),ir=ls;var cs=I("raw"),sr=cs;var ps=function(e,t){if(!t)return{};try{return ir.parse(t,{defaultFieldName:e})}catch{return new sr(t)}},Nn=ps;var ms=I("special"),$n=ms;var ds=I("tag",de,function(){this.serialize=function(){return`${this.value}: (${this.serializedChildren().join(" ")})`}}),Dn=ds;var hs=Ce("value_boolean",de),Ln=hs;var gs={Field:rr,FieldBoolean:Ot,insideFieldNodes:de,Literal:or,parseField:Nn,Raw:sr,Special:$n,Tag:Dn,ValueBoolean:Ln},ae=gs;var xs=new me({url:function(){return D.datastores_url},attempts:function(){return D.init_attempts},failure_message:function(){return z.preset("failed_init")},edit_response:function(){},before_success:function(e){D.default_institution=e.default_institution,D.affiliation=e.affiliation,Se.array=v.map(e.response,function(t){return new nr(t)})}}).request,Bn=xs;var ys=function(e,t,n){n===void 0&&(n=function(s){});let i={complete:!1,source:Se.get(e).get("url")+"/record/"+t,names:[void 0]},a=new Xe(i);return a.renderFull(n),a},Hn=ys;var vs=function(e,t,n){this.searches=n,this.uid=e,this.set=a=>(n.forEach(s=>{s.set(a)}),this);let i=(a,s)=>{let f=this;return function(){let l=G(arguments);return Ue(s,l),n.forEach(h=>{h[a].apply(h,l)}),f}};this.run=i("run"),this.nextPage=i("nextPage"),this.prevPage=i("prevPage"),this.setMute=i("setMute",function(a){t=a}),this.getMute=function(){return t},this.setMute(t)},ar=vs;var _s=function(e,t){e.setMute(!1),e.set({page:1});let n=new ar(null,!0,t);n.set({page:1}),this.uid=e.uid,this.run=i=>(e.run(i),n.run(0),this),this.set=i=>{e.set(i);let a={...i};return["page","facets"].forEach(s=>{delete a[s]}),n.set(a),this},this.nextPage=()=>(e.nextPage(),this),this.prevPage=()=>(e.prevPage(),this),this.switchTo=i=>{if(i!==e){if(e.setMute(!0),e.set({page:1}),n.searches.push(e),e=n.searches.find(a=>a.uid===i),!e)throw new Error(`Could not find a search with a UID of: ${i}`);n.searches=n.searches.filter(a=>a.uid!==i),this.uid=e.uid,e.setMute(!1)}return this}},zn=_s;var ws={deepClone:H,escape:Rt,FuncBuffer:ne,isFunction:K,MultiSearch:ar,Paginator:Ve,request:pe,RequestBuffer:me,safeApply:Ue,safeCall:P,SearchSwitcher:zn,Section:ce,sliceCall:G},kn=ws;var As={AllDatastores:Se,Core:Mn,FieldTree:ae,init:Bn,Messenger:z,Parser:ir,PreferenceEngine:jt,requestRecord:Hn,Settings:D,Util:kn},In=As;
/*! Bundled license information:

reqwest/reqwest.js:
  (*!
    * Reqwest! A general purpose XHR connection manager
    * license MIT (c) Dustin Diaz 2015
    * https://github.com/ded/reqwest
    *)
*/
