var Si=Object.create;var ft=Object.defineProperty;var Oi=Object.getOwnPropertyDescriptor;var Ti=Object.getOwnPropertyNames;var Ri=Object.getPrototypeOf,qi=Object.prototype.hasOwnProperty;var nn=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),on=(e,t)=>{for(var n in t)ft(e,n,{get:t[n],enumerable:!0})},an=(e,t,n,a)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of Ti(t))!qi.call(e,s)&&s!==n&&ft(e,s,{get:()=>t[s],enumerable:!(a=Oi(t,s))||a.enumerable});return e};var Ei=(e,t,n)=>(n=e!=null?Si(Ri(e)):{},an(t||!e||!e.__esModule?ft(n,"default",{value:e,enumerable:!0}):n,e)),bi=e=>an(ft({},"__esModule",{value:!0}),e);var Gn=nn(()=>{});var Jn=nn((exports,module)=>{(function(e,t,n){typeof module<"u"&&module.exports?module.exports=n():typeof define=="function"&&define.amd?define(n):t[e]=n()})("reqwest",exports,function(){var context=this;if("window"in context)var doc=document,byTag="getElementsByTagName",head=doc[byTag]("head")[0];else{var XHR2;try{XHR2=Gn()}catch{throw new Error("Peer dependency `xhr2` required! Please npm install xhr2")}}var httpsRe=/^http/,protocolRe=/(^\w+):\/\//,twoHundo=/^(20\d|1223)$/,readyState="readyState",contentType="Content-Type",requestedWith="X-Requested-With",uniqid=0,callbackPrefix="reqwest_"+ +new Date,lastValue,xmlHttpRequest="XMLHttpRequest",xDomainRequest="XDomainRequest",noop=function(){},isArray=typeof Array.isArray=="function"?Array.isArray:function(e){return e instanceof Array},defaultHeaders={contentType:"application/x-www-form-urlencoded",requestedWith:xmlHttpRequest,accept:{"*":"text/javascript, text/html, application/xml, text/xml, */*",xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript",js:"application/javascript, text/javascript"}},xhr=function(e){if(e.crossOrigin===!0){var t=context[xmlHttpRequest]?new XMLHttpRequest:null;if(t&&"withCredentials"in t)return t;if(context[xDomainRequest])return new XDomainRequest;throw new Error("Browser does not support cross-origin requests")}else return context[xmlHttpRequest]?new XMLHttpRequest:XHR2?new XHR2:new ActiveXObject("Microsoft.XMLHTTP")},globalSetupOptions={dataFilter:function(e){return e}};function succeed(e){var t=protocolRe.exec(e.url);return t=t&&t[1]||context.location.protocol,httpsRe.test(t)?twoHundo.test(e.request.status):!!e.request.response}function handleReadyState(e,t,n){return function(){if(e._aborted)return n(e.request);if(e._timedOut)return n(e.request,"Request is aborted: timeout");e.request&&e.request[readyState]==4&&(e.request.onreadystatechange=noop,succeed(e)?t(e.request):n(e.request))}}function setHeaders(e,t){var n=t.headers||{},a;n.Accept=n.Accept||defaultHeaders.accept[t.type]||defaultHeaders.accept["*"];var s=typeof FormData<"u"&&t.data instanceof FormData;!t.crossOrigin&&!n[requestedWith]&&(n[requestedWith]=defaultHeaders.requestedWith),!n[contentType]&&!s&&(n[contentType]=t.contentType||defaultHeaders.contentType);for(a in n)n.hasOwnProperty(a)&&"setRequestHeader"in e&&e.setRequestHeader(a,n[a])}function setCredentials(e,t){typeof t.withCredentials<"u"&&typeof e.withCredentials<"u"&&(e.withCredentials=!!t.withCredentials)}function generalCallback(e){lastValue=e}function urlappend(e,t){return e+(/\?/.test(e)?"&":"?")+t}function handleJsonp(e,t,n,a){var s=uniqid++,i=e.jsonpCallback||"callback",u=e.jsonpCallbackName||reqwest.getcallbackPrefix(s),c=new RegExp("((^|\\?|&)"+i+")=([^&]+)"),h=a.match(c),m=doc.createElement("script"),F=0,T=navigator.userAgent.indexOf("MSIE 10.0")!==-1;return h?h[3]==="?"?a=a.replace(c,"$1="+u):u=h[3]:a=urlappend(a,i+"="+u),context[u]=generalCallback,m.type="text/javascript",m.src=a,m.async=!0,typeof m.onreadystatechange<"u"&&!T&&(m.htmlFor=m.id="_reqwest_"+s),m.onload=m.onreadystatechange=function(){if(m[readyState]&&m[readyState]!=="complete"&&m[readyState]!=="loaded"||F)return!1;m.onload=m.onreadystatechange=null,m.onclick&&m.onclick(),t(lastValue),lastValue=void 0,head.removeChild(m),F=1},head.appendChild(m),{abort:function(){m.onload=m.onreadystatechange=null,n({},"Request is aborted: timeout",{}),lastValue=void 0,head.removeChild(m),F=1}}}function getRequest(e,t){var n=this.o,a=(n.method||"GET").toUpperCase(),s=typeof n=="string"?n:n.url,i=n.processData!==!1&&n.data&&typeof n.data!="string"?reqwest.toQueryString(n.data):n.data||null,u,c=!1;return(n.type=="jsonp"||a=="GET")&&i&&(s=urlappend(s,i),i=null),n.type=="jsonp"?handleJsonp(n,e,t,s):(u=n.xhr&&n.xhr(n)||xhr(n),u.open(a,s,n.async!==!1),setHeaders(u,n),setCredentials(u,n),context[xDomainRequest]&&u instanceof context[xDomainRequest]?(u.onload=e,u.onerror=t,u.onprogress=function(){},c=!0):u.onreadystatechange=handleReadyState(this,e,t),n.before&&n.before(u),c?setTimeout(function(){u.send(i)},200):u.send(i),u)}function Reqwest(e,t){this.o=e,this.fn=t,init.apply(this,arguments)}function setType(e){if(e!==null){if(e.match("json"))return"json";if(e.match("javascript"))return"js";if(e.match("text"))return"html";if(e.match("xml"))return"xml"}}function init(o,fn){this.url=typeof o=="string"?o:o.url,this.timeout=null,this._fulfilled=!1,this._successHandler=function(){},this._fulfillmentHandlers=[],this._errorHandlers=[],this._completeHandlers=[],this._erred=!1,this._responseArgs={};var self=this;fn=fn||function(){},o.timeout&&(this.timeout=setTimeout(function(){timedOut()},o.timeout)),o.success&&(this._successHandler=function(){o.success.apply(o,arguments)}),o.error&&this._errorHandlers.push(function(){o.error.apply(o,arguments)}),o.complete&&this._completeHandlers.push(function(){o.complete.apply(o,arguments)});function complete(e){for(o.timeout&&clearTimeout(self.timeout),self.timeout=null;self._completeHandlers.length>0;)self._completeHandlers.shift()(e)}function success(resp){var type=o.type||resp&&setType(resp.getResponseHeader("Content-Type"));resp=type!=="jsonp"?self.request:resp;var filteredResponse=globalSetupOptions.dataFilter(resp.responseText,type),r=filteredResponse;try{resp.responseText=r}catch(e){}if(r)switch(type){case"json":try{resp=context.JSON?context.JSON.parse(r):eval("("+r+")")}catch(e){return error(resp,"Could not parse JSON in response",e)}break;case"js":resp=eval(r);break;case"html":resp=r;break;case"xml":resp=resp.responseXML&&resp.responseXML.parseError&&resp.responseXML.parseError.errorCode&&resp.responseXML.parseError.reason?null:resp.responseXML;break}for(self._responseArgs.resp=resp,self._fulfilled=!0,fn(resp),self._successHandler(resp);self._fulfillmentHandlers.length>0;)resp=self._fulfillmentHandlers.shift()(resp);complete(resp)}function timedOut(){self._timedOut=!0,self.request.abort()}function error(e,t,n){for(e=self.request,self._responseArgs.resp=e,self._responseArgs.msg=t,self._responseArgs.t=n,self._erred=!0;self._errorHandlers.length>0;)self._errorHandlers.shift()(e,t,n);complete(e)}this.request=getRequest.call(this,success,error)}Reqwest.prototype={abort:function(){this._aborted=!0,this.request.abort()},retry:function(){init.call(this,this.o,this.fn)},then:function(e,t){return e=e||function(){},t=t||function(){},this._fulfilled?this._responseArgs.resp=e(this._responseArgs.resp):this._erred?t(this._responseArgs.resp,this._responseArgs.msg,this._responseArgs.t):(this._fulfillmentHandlers.push(e),this._errorHandlers.push(t)),this},always:function(e){return this._fulfilled||this._erred?e(this._responseArgs.resp):this._completeHandlers.push(e),this},fail:function(e){return this._erred?e(this._responseArgs.resp,this._responseArgs.msg,this._responseArgs.t):this._errorHandlers.push(e),this},catch:function(e){return this.fail(e)}};function reqwest(e,t){return new Reqwest(e,t)}function normalize(e){return e?e.replace(/\r?\n/g,`\r
`):""}function serial(e,t){var n=e.name,a=e.tagName.toLowerCase(),s=function(m){m&&!m.disabled&&t(n,normalize(m.attributes.value&&m.attributes.value.specified?m.value:m.text))},i,u,c,h;if(!(e.disabled||!n))switch(a){case"input":/reset|button|image|file/i.test(e.type)||(i=/checkbox/i.test(e.type),u=/radio/i.test(e.type),c=e.value,(!(i||u)||e.checked)&&t(n,normalize(i&&c===""?"on":c)));break;case"textarea":t(n,normalize(e.value));break;case"select":if(e.type.toLowerCase()==="select-one")s(e.selectedIndex>=0?e.options[e.selectedIndex]:null);else for(h=0;e.length&&h<e.length;h++)e.options[h].selected&&s(e.options[h]);break}}function eachFormElement(){var e=this,t,n,a=function(s,i){var u,c,h;for(u=0;u<i.length;u++)for(h=s[byTag](i[u]),c=0;c<h.length;c++)serial(h[c],e)};for(n=0;n<arguments.length;n++)t=arguments[n],/input|select|textarea/i.test(t.tagName)&&serial(t,e),a(t,["input","select","textarea"])}function serializeQueryString(){return reqwest.toQueryString(reqwest.serializeArray.apply(null,arguments))}function serializeHash(){var e={};return eachFormElement.apply(function(t,n){t in e?(e[t]&&!isArray(e[t])&&(e[t]=[e[t]]),e[t].push(n)):e[t]=n},arguments),e}reqwest.serializeArray=function(){var e=[];return eachFormElement.apply(function(t,n){e.push({name:t,value:n})},arguments),e},reqwest.serialize=function(){if(arguments.length===0)return"";var e,t,n=Array.prototype.slice.call(arguments,0);return e=n.pop(),e&&e.nodeType&&n.push(e)&&(e=null),e&&(e=e.type),e=="map"?t=serializeHash:e=="array"?t=reqwest.serializeArray:t=serializeQueryString,t.apply(null,n)},reqwest.toQueryString=function(e,t){var n,a,s=t||!1,i=[],u=encodeURIComponent,c=function(h,m){m=typeof m=="function"?m():m??"",i[i.length]=u(h)+"="+u(m)};if(isArray(e))for(a=0;e&&a<e.length;a++)c(e[a].name,e[a].value);else for(n in e)e.hasOwnProperty(n)&&buildParams(n,e[n],s,c);return i.join("&").replace(/%20/g,"+")};function buildParams(e,t,n,a){var s,i,u,c=/\[\]$/;if(isArray(t))for(i=0;t&&i<t.length;i++)u=t[i],n||c.test(e)?a(e,u):buildParams(e+"["+(typeof u=="object"?i:"")+"]",u,n,a);else if(t&&t.toString()==="[object Object]")for(s in t)buildParams(e+"["+s+"]",t[s],n,a);else a(e,t)}return reqwest.getcallbackPrefix=function(){return callbackPrefix},reqwest.compat=function(e,t){return e&&(e.type&&(e.method=e.type)&&delete e.type,e.dataType&&(e.type=e.dataType),e.jsonpCallback&&(e.jsonpCallbackName=e.jsonpCallback)&&delete e.jsonpCallback,e.jsonp&&(e.jsonpCallback=e.jsonp)),new Reqwest(e,t)},reqwest.ajaxSetup=function(e){e=e||{};for(var t in e)globalSetupOptions[t]=e[t]},reqwest})});var Qi={};on(Qi,{Pride:()=>l});module.exports=bi(Qi);var Lr={};on(Lr,{VERSION:()=>lt,after:()=>_r,all:()=>Rt,allKeys:()=>W,any:()=>qt,assign:()=>fe,before:()=>Je,bind:()=>Ct,bindAll:()=>Pn,chain:()=>dr,chunk:()=>$r,clone:()=>ir,collect:()=>k,compact:()=>Ur,compose:()=>wr,constant:()=>$e,contains:()=>I,countBy:()=>Hn,create:()=>nr,debounce:()=>xr,default:()=>Wn,defaults:()=>wt,defer:()=>Nn,delay:()=>Ft,detect:()=>Oe,difference:()=>bt,drop:()=>he,each:()=>$,escape:()=>En,every:()=>Rt,extend:()=>yt,extendOwn:()=>fe,filter:()=>Q,find:()=>Oe,findIndex:()=>Se,findKey:()=>Ke,findLastIndex:()=>St,findWhere:()=>Ar,first:()=>ot,flatten:()=>Mr,foldl:()=>Tt,foldr:()=>Cr,forEach:()=>$,functions:()=>Ae,get:()=>Ve,groupBy:()=>In,has:()=>ar,head:()=>ot,identity:()=>ce,include:()=>I,includes:()=>I,indexBy:()=>Bn,indexOf:()=>Ot,initial:()=>it,inject:()=>Tt,intersection:()=>Pr,invert:()=>ze,invoke:()=>Ln,isArguments:()=>we,isArray:()=>H,isArrayBuffer:()=>ht,isBoolean:()=>Ne,isDataView:()=>ae,isDate:()=>hn,isElement:()=>Qt,isEmpty:()=>Kt,isEqual:()=>Zt,isError:()=>vn,isFinite:()=>Jt,isFunction:()=>E,isMap:()=>On,isMatch:()=>He,isNaN:()=>De,isNull:()=>Xt,isNumber:()=>mt,isObject:()=>L,isRegExp:()=>gn,isSet:()=>Rn,isString:()=>xe,isSymbol:()=>dt,isTypedArray:()=>vt,isUndefined:()=>Pe,isWeakMap:()=>Tn,isWeakSet:()=>qn,iteratee:()=>Ce,keys:()=>A,last:()=>br,lastIndexOf:()=>$n,map:()=>k,mapObject:()=>sr,matcher:()=>Z,matches:()=>Z,max:()=>tt,memoize:()=>gr,methods:()=>Ae,min:()=>Or,mixin:()=>at,negate:()=>me,noop:()=>Qe,now:()=>ne,object:()=>Nr,omit:()=>kn,once:()=>Dn,pairs:()=>rr,partial:()=>ie,partition:()=>zn,pick:()=>Et,pluck:()=>de,property:()=>pe,propertyOf:()=>ur,random:()=>Fe,range:()=>Dr,reduce:()=>Tt,reduceRight:()=>Cr,reject:()=>Fr,rest:()=>he,restArguments:()=>q,result:()=>pr,sample:()=>nt,select:()=>Q,shuffle:()=>Tr,size:()=>qr,some:()=>qt,sortBy:()=>Rr,sortedIndex:()=>Ze,tail:()=>he,take:()=>ot,tap:()=>or,template:()=>cr,templateSettings:()=>Mn,throttle:()=>vr,times:()=>fr,toArray:()=>rt,toPath:()=>_t,transpose:()=>Re,unescape:()=>Un,union:()=>Xn,uniq:()=>Te,unique:()=>Te,uniqueId:()=>mr,unzip:()=>Re,values:()=>V,where:()=>Sr,without:()=>Vn,wrap:()=>yr,zip:()=>Qn});var lt="1.13.6",Lt=typeof self=="object"&&self.self===self&&self||typeof global=="object"&&global.global===global&&global||Function("return this")()||{},Me=Array.prototype,ct=Object.prototype,It=typeof Symbol<"u"?Symbol.prototype:null,sn=Me.push,Y=Me.slice,j=ct.toString,un=ct.hasOwnProperty,Bt=typeof ArrayBuffer<"u",ln=typeof DataView<"u",cn=Array.isArray,Ht=Object.keys,zt=Object.create,kt=Bt&&ArrayBuffer.isView,pn=isNaN,mn=isFinite,pt=!{toString:null}.propertyIsEnumerable("toString"),Vt=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],dn=Math.pow(2,53)-1;function q(e,t){return t=t==null?e.length-1:+t,function(){for(var n=Math.max(arguments.length-t,0),a=Array(n),s=0;s<n;s++)a[s]=arguments[s+t];switch(t){case 0:return e.call(this,a);case 1:return e.call(this,arguments[0],a);case 2:return e.call(this,arguments[0],arguments[1],a)}var i=Array(t+1);for(s=0;s<t;s++)i[s]=arguments[s];return i[t]=a,e.apply(this,i)}}function L(e){var t=typeof e;return t==="function"||t==="object"&&!!e}function Xt(e){return e===null}function Pe(e){return e===void 0}function Ne(e){return e===!0||e===!1||j.call(e)==="[object Boolean]"}function Qt(e){return!!(e&&e.nodeType===1)}function O(e){var t="[object "+e+"]";return function(n){return j.call(n)===t}}var xe=O("String");var mt=O("Number");var hn=O("Date");var gn=O("RegExp");var vn=O("Error");var dt=O("Symbol");var ht=O("ArrayBuffer");var xn=O("Function"),Ui=Lt.document&&Lt.document.childNodes;typeof/./!="function"&&typeof Int8Array!="object"&&typeof Ui!="function"&&(xn=function(e){return typeof e=="function"||!1});var E=xn;var Wt=O("Object");var gt=ln&&Wt(new DataView(new ArrayBuffer(8))),ye=typeof Map<"u"&&Wt(new Map);var Mi=O("DataView");function Pi(e){return e!=null&&E(e.getInt8)&&ht(e.buffer)}var ae=gt?Pi:Mi;var H=cn||O("Array");function D(e,t){return e!=null&&un.call(e,t)}var Gt=O("Arguments");(function(){Gt(arguments)||(Gt=function(e){return D(e,"callee")})})();var we=Gt;function Jt(e){return!dt(e)&&mn(e)&&!isNaN(parseFloat(e))}function De(e){return mt(e)&&pn(e)}function $e(e){return function(){return e}}function Le(e){return function(t){var n=e(t);return typeof n=="number"&&n>=0&&n<=dn}}function Ie(e){return function(t){return t?.[e]}}var se=Ie("byteLength");var yn=Le(se);var Ni=/\[object ((I|Ui)nt(8|16|32)|Float(32|64)|Uint8Clamped|Big(I|Ui)nt64)Array\]/;function Di(e){return kt?kt(e)&&!ae(e):yn(e)&&Ni.test(j.call(e))}var vt=Bt?Di:$e(!1);var b=Ie("length");function $i(e){for(var t={},n=e.length,a=0;a<n;++a)t[e[a]]=!0;return{contains:function(s){return t[s]===!0},push:function(s){return t[s]=!0,e.push(s)}}}function Be(e,t){t=$i(t);var n=Vt.length,a=e.constructor,s=E(a)&&a.prototype||ct,i="constructor";for(D(e,i)&&!t.contains(i)&&t.push(i);n--;)i=Vt[n],i in e&&e[i]!==s[i]&&!t.contains(i)&&t.push(i)}function A(e){if(!L(e))return[];if(Ht)return Ht(e);var t=[];for(var n in e)D(e,n)&&t.push(n);return pt&&Be(e,t),t}function Kt(e){if(e==null)return!0;var t=b(e);return typeof t=="number"&&(H(e)||xe(e)||we(e))?t===0:b(A(e))===0}function He(e,t){var n=A(t),a=n.length;if(e==null)return!a;for(var s=Object(e),i=0;i<a;i++){var u=n[i];if(t[u]!==s[u]||!(u in s))return!1}return!0}function y(e){if(e instanceof y)return e;if(!(this instanceof y))return new y(e);this._wrapped=e}y.VERSION=lt;y.prototype.value=function(){return this._wrapped};y.prototype.valueOf=y.prototype.toJSON=y.prototype.value;y.prototype.toString=function(){return String(this._wrapped)};function xt(e){return new Uint8Array(e.buffer||e,e.byteOffset||0,se(e))}var wn="[object DataView]";function Yt(e,t,n,a){if(e===t)return e!==0||1/e===1/t;if(e==null||t==null)return!1;if(e!==e)return t!==t;var s=typeof e;return s!=="function"&&s!=="object"&&typeof t!="object"?!1:_n(e,t,n,a)}function _n(e,t,n,a){e instanceof y&&(e=e._wrapped),t instanceof y&&(t=t._wrapped);var s=j.call(e);if(s!==j.call(t))return!1;if(gt&&s=="[object Object]"&&ae(e)){if(!ae(t))return!1;s=wn}switch(s){case"[object RegExp]":case"[object String]":return""+e==""+t;case"[object Number]":return+e!=+e?+t!=+t:+e==0?1/+e===1/t:+e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object Symbol]":return It.valueOf.call(e)===It.valueOf.call(t);case"[object ArrayBuffer]":case wn:return _n(xt(e),xt(t),n,a)}var i=s==="[object Array]";if(!i&&vt(e)){var u=se(e);if(u!==se(t))return!1;if(e.buffer===t.buffer&&e.byteOffset===t.byteOffset)return!0;i=!0}if(!i){if(typeof e!="object"||typeof t!="object")return!1;var c=e.constructor,h=t.constructor;if(c!==h&&!(E(c)&&c instanceof c&&E(h)&&h instanceof h)&&"constructor"in e&&"constructor"in t)return!1}n=n||[],a=a||[];for(var m=n.length;m--;)if(n[m]===e)return a[m]===t;if(n.push(e),a.push(t),i){if(m=e.length,m!==t.length)return!1;for(;m--;)if(!Yt(e[m],t[m],n,a))return!1}else{var F=A(e),T;if(m=F.length,A(t).length!==m)return!1;for(;m--;)if(T=F[m],!(D(t,T)&&Yt(e[T],t[T],n,a)))return!1}return n.pop(),a.pop(),!0}function Zt(e,t){return Yt(e,t)}function W(e){if(!L(e))return[];var t=[];for(var n in e)t.push(n);return pt&&Be(e,t),t}function _e(e){var t=b(e);return function(n){if(n==null)return!1;var a=W(n);if(b(a))return!1;for(var s=0;s<t;s++)if(!E(n[e[s]]))return!1;return e!==tr||!E(n[jt])}}var jt="forEach",An="has",er=["clear","delete"],Cn=["get",An,"set"],Fn=er.concat(jt,Cn),tr=er.concat(Cn),Sn=["add"].concat(er,jt,An);var On=ye?_e(Fn):O("Map");var Tn=ye?_e(tr):O("WeakMap");var Rn=ye?_e(Sn):O("Set");var qn=O("WeakSet");function V(e){for(var t=A(e),n=t.length,a=Array(n),s=0;s<n;s++)a[s]=e[t[s]];return a}function rr(e){for(var t=A(e),n=t.length,a=Array(n),s=0;s<n;s++)a[s]=[t[s],e[t[s]]];return a}function ze(e){for(var t={},n=A(e),a=0,s=n.length;a<s;a++)t[e[n[a]]]=n[a];return t}function Ae(e){var t=[];for(var n in e)E(e[n])&&t.push(n);return t.sort()}function ue(e,t){return function(n){var a=arguments.length;if(t&&(n=Object(n)),a<2||n==null)return n;for(var s=1;s<a;s++)for(var i=arguments[s],u=e(i),c=u.length,h=0;h<c;h++){var m=u[h];(!t||n[m]===void 0)&&(n[m]=i[m])}return n}}var yt=ue(W);var fe=ue(A);var wt=ue(W,!0);function Li(){return function(){}}function ke(e){if(!L(e))return{};if(zt)return zt(e);var t=Li();t.prototype=e;var n=new t;return t.prototype=null,n}function nr(e,t){var n=ke(e);return t&&fe(n,t),n}function ir(e){return L(e)?H(e)?e.slice():yt({},e):e}function or(e,t){return t(e),e}function _t(e){return H(e)?e:[e]}y.toPath=_t;function G(e){return y.toPath(e)}function le(e,t){for(var n=t.length,a=0;a<n;a++){if(e==null)return;e=e[t[a]]}return n?e:void 0}function Ve(e,t,n){var a=le(e,G(t));return Pe(a)?n:a}function ar(e,t){t=G(t);for(var n=t.length,a=0;a<n;a++){var s=t[a];if(!D(e,s))return!1;e=e[s]}return!!n}function ce(e){return e}function Z(e){return e=fe({},e),function(t){return He(t,e)}}function pe(e){return e=G(e),function(t){return le(t,e)}}function J(e,t,n){if(t===void 0)return e;switch(n??3){case 1:return function(a){return e.call(t,a)};case 3:return function(a,s,i){return e.call(t,a,s,i)};case 4:return function(a,s,i,u){return e.call(t,a,s,i,u)}}return function(){return e.apply(t,arguments)}}function Xe(e,t,n){return e==null?ce:E(e)?J(e,t,n):L(e)&&!H(e)?Z(e):pe(e)}function Ce(e,t){return Xe(e,t,1/0)}y.iteratee=Ce;function R(e,t,n){return y.iteratee!==Ce?y.iteratee(e,t):Xe(e,t,n)}function sr(e,t,n){t=R(t,n);for(var a=A(e),s=a.length,i={},u=0;u<s;u++){var c=a[u];i[c]=t(e[c],c,e)}return i}function Qe(){}function ur(e){return e==null?Qe:function(t){return Ve(e,t)}}function fr(e,t,n){var a=Array(Math.max(0,e));t=J(t,n,1);for(var s=0;s<e;s++)a[s]=t(s);return a}function Fe(e,t){return t==null&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))}var ne=Date.now||function(){return new Date().getTime()};function We(e){var t=function(i){return e[i]},n="(?:"+A(e).join("|")+")",a=RegExp(n),s=RegExp(n,"g");return function(i){return i=i==null?"":""+i,a.test(i)?i.replace(s,t):i}}var At={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"};var En=We(At);var bn=ze(At);var Un=We(bn);var Mn=y.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var lr=/(.)^/,Ii={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},Bi=/\\|'|\r|\n|\u2028|\u2029/g;function Hi(e){return"\\"+Ii[e]}var zi=/^\s*(\w|\$)+\s*$/;function cr(e,t,n){!t&&n&&(t=n),t=wt({},t,y.templateSettings);var a=RegExp([(t.escape||lr).source,(t.interpolate||lr).source,(t.evaluate||lr).source].join("|")+"|$","g"),s=0,i="__p+='";e.replace(a,function(m,F,T,w,_){return i+=e.slice(s,_).replace(Bi,Hi),s=_+m.length,F?i+=`'+
((__t=(`+F+`))==null?'':_.escape(__t))+
'`:T?i+=`'+
((__t=(`+T+`))==null?'':__t)+
'`:w&&(i+=`';
`+w+`
__p+='`),m}),i+=`';
`;var u=t.variable;if(u){if(!zi.test(u))throw new Error("variable is not a bare identifier: "+u)}else i=`with(obj||{}){
`+i+`}
`,u="obj";i=`var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};
`+i+`return __p;
`;var c;try{c=new Function(u,"_",i)}catch(m){throw m.source=i,m}var h=function(m){return c.call(this,m,y)};return h.source="function("+u+`){
`+i+"}",h}function pr(e,t,n){t=G(t);var a=t.length;if(!a)return E(n)?n.call(e):n;for(var s=0;s<a;s++){var i=e?.[t[s]];i===void 0&&(i=n,s=a),e=E(i)?i.call(e):i}return e}var ki=0;function mr(e){var t=++ki+"";return e?e+t:t}function dr(e){var t=y(e);return t._chain=!0,t}function Ge(e,t,n,a,s){if(!(a instanceof t))return e.apply(n,s);var i=ke(e.prototype),u=e.apply(i,s);return L(u)?u:i}var hr=q(function(e,t){var n=hr.placeholder,a=function(){for(var s=0,i=t.length,u=Array(i),c=0;c<i;c++)u[c]=t[c]===n?arguments[s++]:t[c];for(;s<arguments.length;)u.push(arguments[s++]);return Ge(e,a,this,this,u)};return a});hr.placeholder=y;var ie=hr;var Ct=q(function(e,t,n){if(!E(e))throw new TypeError("Bind must be called on a function");var a=q(function(s){return Ge(e,a,t,this,n.concat(s))});return a});var U=Le(b);function z(e,t,n,a){if(a=a||[],!t&&t!==0)t=1/0;else if(t<=0)return a.concat(e);for(var s=a.length,i=0,u=b(e);i<u;i++){var c=e[i];if(U(c)&&(H(c)||we(c)))if(t>1)z(c,t-1,n,a),s=a.length;else for(var h=0,m=c.length;h<m;)a[s++]=c[h++];else n||(a[s++]=c)}return a}var Pn=q(function(e,t){t=z(t,!1,!1);var n=t.length;if(n<1)throw new Error("bindAll must be passed function names");for(;n--;){var a=t[n];e[a]=Ct(e[a],e)}return e});function gr(e,t){var n=function(a){var s=n.cache,i=""+(t?t.apply(this,arguments):a);return D(s,i)||(s[i]=e.apply(this,arguments)),s[i]};return n.cache={},n}var Ft=q(function(e,t,n){return setTimeout(function(){return e.apply(null,n)},t)});var Nn=ie(Ft,y,1);function vr(e,t,n){var a,s,i,u,c=0;n||(n={});var h=function(){c=n.leading===!1?0:ne(),a=null,u=e.apply(s,i),a||(s=i=null)},m=function(){var F=ne();!c&&n.leading===!1&&(c=F);var T=t-(F-c);return s=this,i=arguments,T<=0||T>t?(a&&(clearTimeout(a),a=null),c=F,u=e.apply(s,i),a||(s=i=null)):!a&&n.trailing!==!1&&(a=setTimeout(h,T)),u};return m.cancel=function(){clearTimeout(a),c=0,a=s=i=null},m}function xr(e,t,n){var a,s,i,u,c,h=function(){var F=ne()-s;t>F?a=setTimeout(h,t-F):(a=null,n||(u=e.apply(c,i)),a||(i=c=null))},m=q(function(F){return c=this,i=F,s=ne(),a||(a=setTimeout(h,t),n&&(u=e.apply(c,i))),u});return m.cancel=function(){clearTimeout(a),a=i=c=null},m}function yr(e,t){return ie(t,e)}function me(e){return function(){return!e.apply(this,arguments)}}function wr(){var e=arguments,t=e.length-1;return function(){for(var n=t,a=e[t].apply(this,arguments);n--;)a=e[n].call(this,a);return a}}function _r(e,t){return function(){if(--e<1)return t.apply(this,arguments)}}function Je(e,t){var n;return function(){return--e>0&&(n=t.apply(this,arguments)),e<=1&&(t=null),n}}var Dn=ie(Je,2);function Ke(e,t,n){t=R(t,n);for(var a=A(e),s,i=0,u=a.length;i<u;i++)if(s=a[i],t(e[s],s,e))return s}function Ye(e){return function(t,n,a){n=R(n,a);for(var s=b(t),i=e>0?0:s-1;i>=0&&i<s;i+=e)if(n(t[i],i,t))return i;return-1}}var Se=Ye(1);var St=Ye(-1);function Ze(e,t,n,a){n=R(n,a,1);for(var s=n(t),i=0,u=b(e);i<u;){var c=Math.floor((i+u)/2);n(e[c])<s?i=c+1:u=c}return i}function je(e,t,n){return function(a,s,i){var u=0,c=b(a);if(typeof i=="number")e>0?u=i>=0?i:Math.max(i+c,u):c=i>=0?Math.min(i+1,c):i+c+1;else if(n&&i&&c)return i=n(a,s),a[i]===s?i:-1;if(s!==s)return i=t(Y.call(a,u,c),De),i>=0?i+u:-1;for(i=e>0?u:c-1;i>=0&&i<c;i+=e)if(a[i]===s)return i;return-1}}var Ot=je(1,Se,Ze);var $n=je(-1,St);function Oe(e,t,n){var a=U(e)?Se:Ke,s=a(e,t,n);if(s!==void 0&&s!==-1)return e[s]}function Ar(e,t){return Oe(e,Z(t))}function $(e,t,n){t=J(t,n);var a,s;if(U(e))for(a=0,s=e.length;a<s;a++)t(e[a],a,e);else{var i=A(e);for(a=0,s=i.length;a<s;a++)t(e[i[a]],i[a],e)}return e}function k(e,t,n){t=R(t,n);for(var a=!U(e)&&A(e),s=(a||e).length,i=Array(s),u=0;u<s;u++){var c=a?a[u]:u;i[u]=t(e[c],c,e)}return i}function et(e){var t=function(n,a,s,i){var u=!U(n)&&A(n),c=(u||n).length,h=e>0?0:c-1;for(i||(s=n[u?u[h]:h],h+=e);h>=0&&h<c;h+=e){var m=u?u[h]:h;s=a(s,n[m],m,n)}return s};return function(n,a,s,i){var u=arguments.length>=3;return t(n,J(a,i,4),s,u)}}var Tt=et(1);var Cr=et(-1);function Q(e,t,n){var a=[];return t=R(t,n),$(e,function(s,i,u){t(s,i,u)&&a.push(s)}),a}function Fr(e,t,n){return Q(e,me(R(t)),n)}function Rt(e,t,n){t=R(t,n);for(var a=!U(e)&&A(e),s=(a||e).length,i=0;i<s;i++){var u=a?a[i]:i;if(!t(e[u],u,e))return!1}return!0}function qt(e,t,n){t=R(t,n);for(var a=!U(e)&&A(e),s=(a||e).length,i=0;i<s;i++){var u=a?a[i]:i;if(t(e[u],u,e))return!0}return!1}function I(e,t,n,a){return U(e)||(e=V(e)),(typeof n!="number"||a)&&(n=0),Ot(e,t,n)>=0}var Ln=q(function(e,t,n){var a,s;return E(t)?s=t:(t=G(t),a=t.slice(0,-1),t=t[t.length-1]),k(e,function(i){var u=s;if(!u){if(a&&a.length&&(i=le(i,a)),i==null)return;u=i[t]}return u==null?u:u.apply(i,n)})});function de(e,t){return k(e,pe(t))}function Sr(e,t){return Q(e,Z(t))}function tt(e,t,n){var a=-1/0,s=-1/0,i,u;if(t==null||typeof t=="number"&&typeof e[0]!="object"&&e!=null){e=U(e)?e:V(e);for(var c=0,h=e.length;c<h;c++)i=e[c],i!=null&&i>a&&(a=i)}else t=R(t,n),$(e,function(m,F,T){u=t(m,F,T),(u>s||u===-1/0&&a===-1/0)&&(a=m,s=u)});return a}function Or(e,t,n){var a=1/0,s=1/0,i,u;if(t==null||typeof t=="number"&&typeof e[0]!="object"&&e!=null){e=U(e)?e:V(e);for(var c=0,h=e.length;c<h;c++)i=e[c],i!=null&&i<a&&(a=i)}else t=R(t,n),$(e,function(m,F,T){u=t(m,F,T),(u<s||u===1/0&&a===1/0)&&(a=m,s=u)});return a}var Vi=/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g;function rt(e){return e?H(e)?Y.call(e):xe(e)?e.match(Vi):U(e)?k(e,ce):V(e):[]}function nt(e,t,n){if(t==null||n)return U(e)||(e=V(e)),e[Fe(e.length-1)];var a=rt(e),s=b(a);t=Math.max(Math.min(t,s),0);for(var i=s-1,u=0;u<t;u++){var c=Fe(u,i),h=a[u];a[u]=a[c],a[c]=h}return a.slice(0,t)}function Tr(e){return nt(e,1/0)}function Rr(e,t,n){var a=0;return t=R(t,n),de(k(e,function(s,i,u){return{value:s,index:a++,criteria:t(s,i,u)}}).sort(function(s,i){var u=s.criteria,c=i.criteria;if(u!==c){if(u>c||u===void 0)return 1;if(u<c||c===void 0)return-1}return s.index-i.index}),"value")}function ee(e,t){return function(n,a,s){var i=t?[[],[]]:{};return a=R(a,s),$(n,function(u,c){var h=a(u,c,n);e(i,u,h)}),i}}var In=ee(function(e,t,n){D(e,n)?e[n].push(t):e[n]=[t]});var Bn=ee(function(e,t,n){e[n]=t});var Hn=ee(function(e,t,n){D(e,n)?e[n]++:e[n]=1});var zn=ee(function(e,t,n){e[n?0:1].push(t)},!0);function qr(e){return e==null?0:U(e)?e.length:A(e).length}function Er(e,t,n){return t in n}var Et=q(function(e,t){var n={},a=t[0];if(e==null)return n;E(a)?(t.length>1&&(a=J(a,t[1])),t=W(e)):(a=Er,t=z(t,!1,!1),e=Object(e));for(var s=0,i=t.length;s<i;s++){var u=t[s],c=e[u];a(c,u,e)&&(n[u]=c)}return n});var kn=q(function(e,t){var n=t[0],a;return E(n)?(n=me(n),t.length>1&&(a=t[1])):(t=k(z(t,!1,!1),String),n=function(s,i){return!I(t,i)}),Et(e,n,a)});function it(e,t,n){return Y.call(e,0,Math.max(0,e.length-(t==null||n?1:t)))}function ot(e,t,n){return e==null||e.length<1?t==null||n?void 0:[]:t==null||n?e[0]:it(e,e.length-t)}function he(e,t,n){return Y.call(e,t==null||n?1:t)}function br(e,t,n){return e==null||e.length<1?t==null||n?void 0:[]:t==null||n?e[e.length-1]:he(e,Math.max(0,e.length-t))}function Ur(e){return Q(e,Boolean)}function Mr(e,t){return z(e,t,!1)}var bt=q(function(e,t){return t=z(t,!0,!0),Q(e,function(n){return!I(t,n)})});var Vn=q(function(e,t){return bt(e,t)});function Te(e,t,n,a){Ne(t)||(a=n,n=t,t=!1),n!=null&&(n=R(n,a));for(var s=[],i=[],u=0,c=b(e);u<c;u++){var h=e[u],m=n?n(h,u,e):h;t&&!n?((!u||i!==m)&&s.push(h),i=m):n?I(i,m)||(i.push(m),s.push(h)):I(s,h)||s.push(h)}return s}var Xn=q(function(e){return Te(z(e,!0,!0))});function Pr(e){for(var t=[],n=arguments.length,a=0,s=b(e);a<s;a++){var i=e[a];if(!I(t,i)){var u;for(u=1;u<n&&I(arguments[u],i);u++);u===n&&t.push(i)}}return t}function Re(e){for(var t=e&&tt(e,b).length||0,n=Array(t),a=0;a<t;a++)n[a]=de(e,a);return n}var Qn=q(Re);function Nr(e,t){for(var n={},a=0,s=b(e);a<s;a++)t?n[e[a]]=t[a]:n[e[a][0]]=e[a][1];return n}function Dr(e,t,n){t==null&&(t=e||0,e=0),n||(n=t<e?-1:1);for(var a=Math.max(Math.ceil((t-e)/n),0),s=Array(a),i=0;i<a;i++,e+=n)s[i]=e;return s}function $r(e,t){if(t==null||t<1)return[];for(var n=[],a=0,s=e.length;a<s;)n.push(Y.call(e,a,a+=t));return n}function qe(e,t){return e._chain?y(t).chain():t}function at(e){return $(Ae(e),function(t){var n=y[t]=e[t];y.prototype[t]=function(){var a=[this._wrapped];return sn.apply(a,arguments),qe(this,n.apply(y,a))}}),y}$(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=Me[e];y.prototype[e]=function(){var n=this._wrapped;return n!=null&&(t.apply(n,arguments),(e==="shift"||e==="splice")&&n.length===0&&delete n[0]),qe(this,n)}});$(["concat","join","slice"],function(e){var t=Me[e];y.prototype[e]=function(){var n=this._wrapped;return n!=null&&(n=t.apply(n,arguments)),qe(this,n)}});var Wn=y;var Ir=at(Lr);Ir._=Ir;var d=Ir;var Kn=Ei(Jn()),l={};l.Util={};l.Core={};l.Settings={default_cache_size:20,cache_size:{},datastores_url:"",connection_attempts:3,init_attempts:3,ms_between_attempts:1500,message_formats:{failed_record_load:"Failed to load $1",failed_search_run:"Failed to search $1",failed_init:"Failed to initialize Pride"},obnoxious:!1};l.Core.Datastore=function(e){e=l.Util.deepClone(e),this.baseQuery=function(){return new l.Core.Query({uid:e.uid,sort:e.default_sort,start:0,count:0,settings:{},field_tree:n(),facets:d.reduce(e.facets,function(a,s){return s.required&&!s.fixed&&(a[s.uid]=s.default_value),a},{})})},this.baseSearch=function(){return new l.Core.DatastoreSearch({datastore:this})},this.runQuery=function(a){return a.url=e.url,l.Util.request(a),this},this.get=function(a){return e[a]},this.update=function(a){d.extend(e,a)};var t=function(a){return d.reduce(e.facets,function(s,i){return s[i.uid]=d.find(a,function(u){return u.uid===i.uid})||i,s},{})},n=function(a){a=a||new l.FieldTree.FieldBoolean("AND");var s=d.reduce(e.fields,function(i,u){return(u.required||u.fixed)&&!i.contains({type:"field",value:u.uid})?(missing_field=new l.FieldTree.Field(u.uid,new l.FieldTree.Literal(u.default_value)),d.isMatch(i,{type:"field_boolean",value:"AND"})?i.addChild(missing_field):new l.FieldTree.FieldBoolean("AND",i,missing_field)):i},a);return s.matches({type:"field_boolean",children:[]})?{}:s}};l.Core.DatastoreSearch=function(e){var t=this,n=new l.Core.SearchBase(e,this);n.createItem=function(i){return new l.Core.Record(i)};var a=[],s=[];this.getFacets=function(){return a},this.uid=n.datastore.get("uid"),this.getData=function(){return{uid:t.uid,metadata:l.Util.deepClone(n.datastore.get("metadata")),sorts:l.Util.deepClone(n.datastore.get("sorts")),selected_sort:n.query.get("sort"),facets:l.Util.deepClone(n.query.get("facets")),fields:l.Util.deepClone(n.datastore.get("fields")),field_tree:l.Util.deepClone(n.query.get("field_tree")),settings:l.Util.deepClone(n.query.get("settings")),page:n.query.get("page"),count:n.query.get("count"),total_available:n.query.get("total_available"),total_pages:n.query.get("total_pages"),page_limit:n.query.get("page_limit"),specialists:l.Util.deepClone(n.query.get("specialists"))}},this.getResults=n.results,n.initialize_observables=function(){t.runDataObservers.add(function(){var i=n.datastore.get("facets");l.Util.isDeepMatch(s,i)||(d.each(a,function(u){u.clearAllObservers()}),a=d.map(i,function(u){return new l.Core.FacetSearch({data:d.omit(u,"values"),results:u.values})}),s=i,t.facetsObservers.notify())})},this.getMute=n.getMute,this.setMute=function(i){return d.each(a,function(u){u.setMute(i)}),n.setMute(i),t},n.createObservable("facets",this.getFacets).initialize_observables()};l.Core.FacetSearch=function(e){var t=this,n=e.data,a=e.results;this.uid=n.uid,this.getData=function(){return n},this.getResults=function(){return a};var s=!1;this.getMute=function(){return s},this.setMute=function(c){return s=c,self};var i=[];this.clearAllObservers=function(){return d.each(i,function(c){c.clearAll()}),self};var u=function(c,h){var m=new l.Util.FuncBuffer(function(){var F=this.add,T=this.call;i.push(this),this.add=function(w){return self.muted||w(h()),F(w,"observers"),this},this.notify=function(){return self.muted||(n=h(),self.log("NOTIFY ("+c+")",n),T("observers",n)),this}});return m};this.resultsObservers=u("results",this.getResults),this.setDataObservers=u("setData",this.getData),this.runDataObservers=u("runData",this.getData)};l.FieldTree={};l.Core.nodeFactory=function(e,t,n){return function(a){this.children=l.Util.slice(arguments,1),this.children.length===1&&Array.isArray(this.children[0])&&(this.children=this.children[0]),this.type=e,this.value=a.trim(),this.child_types=t||[],this.validIfEmpty=!0,this.addChild=function(s){if(d.find(this.child_types,function(i){return s.type===i}))this.children.push(s);else throw"Not a valid child for a "+this.type;return this},this.contains=function(s){return this.matches(s)?this:d.isEmpty(this.children)?!1:d.find(this.children,function(i){return i.contains(s)})},this.matches=function(s){var i=this,u=s.children||[];return d.every(d.omit(s,"children"),function(c,h){return i[h]==c})&&d.every(u,function(c){return d.any(children,function(h){return c.matches(h)})})},this.serialize=function(){return a},this.serializedChildren=function(){return d.chain(this.children).map(function(s){return s.serialize()}).compact().value()},this.toJSON=function(){return d.mapObject(d.pick(this,"value","children","type"),function(s,i){return i=="children"?d.map(s,function(u){return u.toJSON()}):s})},d.isFunction(n)&&n.call(this)}};l.Core.boolNodeFactory=function(e,t){return l.Core.nodeFactory(e,t,function(){if(!d.contains(["AND","OR","NOT"],this.value))throw"Not a valid boolean value";this.serialize=function(){return this.serializedChildren().join(" "+this.value+" ")},this.serializedChildren=function(){var n=this;return d.chain(n.children).map(function(a){return a.type==n.type||a.type=="literal"&&a.value.match(/\s/)?"("+a.serialize()+")":a.serialize()}).compact().value()}})};var Xi=["field_boolean","field"],Br=["value_boolean","literal","tag","special"];l.FieldTree.FieldBoolean=l.Core.boolNodeFactory("field_boolean",Xi);l.FieldTree.ValueBoolean=l.Core.boolNodeFactory("value_boolean",Br);l.FieldTree.Field=l.Core.nodeFactory("field",Br,function(){this.serialize=function(){return this.value+": ("+this.serializedChildren().join(" ")+")"}});l.FieldTree.Tag=l.Core.nodeFactory("tag",Br,function(){this.serialize=function(){var e=this.serializedChildren();return e.length===0?"":this.value+"("+e.join(" ")+")"}});l.FieldTree.Literal=l.Core.nodeFactory("literal");l.FieldTree.Special=l.Core.nodeFactory("special");l.FieldTree.Raw=l.Core.nodeFactory("raw");l.Util.FuncBuffer=function(e){var t={},n=this,a=function(s){return d.has(t,s)||(t[s]=[]),t[s]};this.add=function(s,i){return a(i).push(s),n},this.remove=function(s,i){return t[i]=d.reject(a(i),function(u){return s==u}),n},this.clear=function(s){return delete t[s],n},this.clearAll=function(){return t={},n},this.call=function(s){return n.apply(s,l.Util.slice(arguments,1)),n},this.apply=function(s,i){return d.each(a(s),function(u){l.Util.safeApply(u,i)}),n},d.isFunction(e)&&e.call(this)};l.Core.GetThis=function(e,t){this.barcode=e,this.data=t;var n=function(u){var c;return d.each(u.fields,function(h){h.uid==="get_this_url"&&(c=h.value)}),c},a=function(u){var c;return d.each(u.fields,function(h){h.uid=="links"&&(c=h.value)}),c},s=new l.Util.RequestBuffer({url:n(t)+"/"+this.barcode,failure_message:l.Messenger.preset("failed_get_this_load",t.names[0]),edit_response:function(u){return t=i(u),t}}),i=function(u){return u};this.getData=function(u){s.request({success:u})}};l.Core.Holdings=function(e){this.data=e;let t=function(a){let s=a.fields.find(i=>i.uid==="resource_access");return s&&s.value?s.value:s},n=function(a){return[t(e)].concat(a)};this.getData=function(a){l.Util.safeCall(a,n(this.data.holdings))}};l.Util.MultiSearch=function(e,t,n){var a={},s=this;this.searches=n,this.uid=e,this.set=function(u){return d.extend(a,u),d.each(n,function(c){c.set(u)}),s};var i=function(u,c){return function(){var h=l.Util.slice(arguments);return l.Util.safeApply(c,h),d.each(n,function(m){m[u].apply(m,h)}),s}};this.run=i("run"),this.nextPage=i("nextPage"),this.prevPage=i("prevPage"),this.setMute=i("setMute",function(u){t=u}),this.getMute=function(){return t},this.setMute(t)};l.Util.Paginater=function(e){this.set=function(n){if(d.has(n,"total_pages"))throw"Can not set total_pages (it is a calculated value)";if(d.has(n,"index_limit"))throw"Can not set index_limit (it is a calculated value)";if(d.intersection(["start","end","count"],d.keys(n)).length>2)throw"Can not set start, end and count all at the same time";if(d.has(n,"page")&&(d.has(n,"start")||d.has(n,"end")))throw"Can not set page as well as the start and/or end";if(d.extend(t,d.omit(n,"end")),d.has(n,"page")&&(t.start=(t.count||0)*(t.page-1)),d.has(n,"end")){if(d.has(n,"count"))t.start=Math.max(0,n.end-(t.count-1));else if(t.start<=n.end)t.count=n.end-t.start+1;else throw"The start value can not be greater than the end value";t.end=n.end}else{var a=t.start+t.count-1;t.end=a<t.start?void 0:a}if(d.isNumber(t.total_available)?t.total_available>0?t.index_limit=t.total_available-1:t.index_limit=void 0:t.index_limit=1/0,t.count>0&&t.start%t.count===0?(t.page=Math.floor(t.start/t.count)+1,d.isNumber(t.total_available)?(t.total_pages=Math.ceil(t.total_available/t.count),t.page_limit=t.total_pages):(t.total_pages=void 0,t.page_limit=1/0)):(t.page=void 0,t.total_pages=void 0,t.page_limit=void 0),!d.has(t,"start")||!d.has(t,"count"))throw"Not enough information given to create Paginater";return this},this.get=function(n){return t[n]};var t={};this.set(e)};l.Util.Paginater.getPossibleKeys=function(){return["start","count","end","page","index_limit","total_pages","total_available","page_limit"]};l.Util.Paginater.hasKey=function(e){return l.Util.Paginater.getPossibleKeys().indexOf(e)>-1};l.Core.Query=function(e){var t=new l.Util.Paginater({start:e.start,count:e.count}),n=l.Util.Paginater.getPossibleKeys();e=d.omit(l.Util.deepClone(e),n),e.request_id=e.request_id||0,this.get=function(a){return l.Util.Paginater.hasKey(a)?t.get(a):e[a]},this.set=function(a){var s=d.pick(a,n),i=d.omit(a,n);return d.isEmpty(i)||(t.set({total_available:void 0}),d.isNumber(i.request_id)||(e.request_id+=1)),t.set(s),d.extend(e,i),this},this.clone=function(){var a=l.Util.deepClone(e);return a.start=t.get("start"),a.count=t.get("count"),new l.Core.Query(a)},this.toSection=function(){return new l.Util.Section(this.get("start"),this.get("end"))},this.toLimitSection=function(){return new l.Util.Section(this.get("start"),this.get("index_limit"))},this.toJSON=function(){return{uid:this.get("uid"),request_id:this.get("request_id"),start:this.get("start"),count:this.get("count"),field_tree:this.get("field_tree"),facets:this.get("facets"),sort:this.get("sort"),settings:this.get("settings"),raw_query:this.get("raw_query")}}};l.Core.Record=function(e){var t=new l.Util.RequestBuffer({url:e.source,failure_message:l.Messenger.preset("failed_record_load",e.names[0]),edit_response:function(u){return e=i(u),e}}),n=null,a={};this.placeHold=function(u,c,h,m){this.renderFull(function(F){var T=function(){var _;return d.each(F.fields,function(v){v.uid==="holdings_url"&&(_=v.value)}),_},w=l.Util.request({url:[T(),u,c,h].join("/"),query:!0,failure:function(_){l.Messenger.sendMessage({summary:"Failed to place hold",class:"error"})},success:m,failure_message:"placeHold failed",success_message:"placeHold succeeded"})})},this.getHoldings=function(u){n?n.getData(u):e.complete?(n=new l.Core.Holdings(e),n.getData(u)):t.request({success:function(c){n=new l.Core.Holdings(c),n.getData(u)}})},this.getGetThis=function(u,c){a[u]?a[u].getData(c):e.complete?(a[u]=new l.Core.GetThis(u,e),a[u].getData(c)):t.request({success:function(h){a[u]=new l.Core.GetThis(u,h),a[u].getData(c)}})},this.renderPart=function(u){s(u)},this.renderPartThenCache=function(u){s(u),t.request()},this.renderFull=function(u){e.complete?s(u):t.request({success:u})},this.renderCSL=function(u){this.renderFull(function(c){var h;d.each(c.fields,function(m){m.uid==="csl"&&(h=m.value)}),u(h)})};var s=function(u){u(d.omit(e,"complete","source"),e.complete)},i=function(u){return u.fields=d.map(u.fields,function(c){return c.value_has_html||(c.value=l.Util.escape(c.value)),d.omit(c,"value_has_html")}),u.names_have_html||(u.names=d.map(u.names,function(c){return l.Util.escape(c)})),u.uid?u.status=200:u.status=404,l.PreferenceEngine.selected(u)&&(u.selected=!0),d.omit(u,"names_have_html")};e=i(e)};l.Util.RequestBuffer=function(e){e=e||{};var t=new l.Util.FuncBuffer,n=!1,a=!1,s=!1,i;this.request=function(m){return t.add(m.success,"success").add(m.failure,"failure"),n?u():c(),this};var u=function(m){i=m||i,a?h("success"):s&&h("failure")},c=function(){n=!0,l.Util.request({url:l.Util.safeCall(e.url),attempts:l.Util.safeCall(e.attempts)||l.Settings.connection_attempts,failure_message:l.Util.safeCall(e.failure_message),failure:function(m){s=!0,l.Util.safeCall(e.before_failure,m),u(m),l.Util.safeCall(e.after_failure,m)},success:function(m){a=!0,l.Util.safeCall(e.before_success,m),d.isFunction(e.edit_response)&&(m=e.edit_response(m)),u(m),l.Util.safeCall(e.after_success,m)}})},h=function(m){t.call(m,i).clearAll()}};l.Core.SearchBase=function(e,t){this.datastore=e.datastore,this.query=e.query||this.datastore.baseQuery();var n=this,a=e.requestFunc||this.datastore.runQuery,s=e.starting_results||[],i=e.cache_size||l.Settings.cache_size[this.datastore.uid]||l.Settings.default_cache_size;this.log=function(){var v=l.Util.slice(arguments);v.unshift("Search ("+n.datastore.get("uid")+")"),l.Core.log.apply(window,v)},this.set=function(v){return n.query.set(v),l.Util.safeCall(n.setDataChanged),d.isEmpty(d.omit(v,l.Util.Paginater.getPossibleKeys()))||(s=[]),n},this.run=function(v){return l.Util.safeCall(n.resultsChanged),d.isUndefined(v)&&(v=i),u(m(n.query.toSection().expanded(v))),n},this.results=function(){return F(new l.Util.Section(n.query.get("start"),Math.min(n.query.get("end"),n.query.get("index_limit"))))};var u=function(v){if(n.log("REQUESTING",v),n.log("TOTAL AVAILABLE (pre-request)",n.query.get("total_available")),v&&n.query.toLimitSection().overlaps(v)){n.log("Sending query...");var C=n.query.clone().set({start:v.start,count:v.calcLength()});a({query:C,failure_message:l.Messenger.preset("failed_search_run",n.datastore.get("metadata").name),success:function(M){if(M.request.request_id==n.query.get("request_id")){h(M),c(M.response,C.get("start"));var X=M.response.length;X!==0&&X<C.get("count")&&u(v.shifted(X,0))}}})}else l.Util.safeCall(n.runDataChanged)},c=function(v,C){var M=!1;n.log("NEW RECORDS",v),d.each(v,function(X,Ee){var oe=Ee+C;d.isUndefined(s[oe])&&(s[oe]=l.Util.safeCall(n.createItem,X),n.query.toSection().inSection(oe)&&(M=!0))}),n.log("CACHE LENGTH",s.length),(M||d.isEmpty(v))&&l.Util.safeCall(n.resultsChanged)},h=function(v){n.datastore.update(v.datastore);var C=d.omit(v.new_request,"start","count");C.specialists=v.specialists,C.total_available=v.total_available,n.query.set(C),l.Util.safeCall(n.runDataChanged)},m=function(v){var C=F(v),M=d.indexOf(C,void 0);if(M!=-1){var X=v.start+d.lastIndexOf(C,void 0);return M+=v.start,new l.Util.Section(M,X)}},F=function(v){for(var C=[],M=v.start;M<=v.end;M++)C.push(s[M]);return C},T=!1,w=[],_=[];this.clearAllObservers=function(){return d.each(w,function(v){v.clearAll()}),l.Util.safeCall(n.initialize_observables),n},this.getMute=function(){return T},this.setMute=function(v){return v!=T&&(T=v,l.Util.safeCall(n.muteChanged()),T||d.each(_,function(C){C.notify()})),n},this.createObservable=function(v,C,M){var X=new l.Util.FuncBuffer(function(){var Ee=this.add,oe=this.call;w.push(this),M||_.push(this),this.add=function(te){return(!n.muted||M)&&te(C()),Ee(te,"observers"),this},this.notify=function(){if(!n.muted||M){var te=C();n.log("NOTIFY ("+v+")",te),oe("observers",te)}return this}});return n[v+"Changed"]=X.notify,t[v+"Observers"]=X,n},this.createObservable("mute",this.getMute,!0).createObservable("setData",function(){t.getData()}).createObservable("runData",function(){t.getData()}).createObservable("results",this.results),t.set=function(v){return n.set(v),t},t.run=function(v){return n.run(v),t},t.nextPage=function(v){var C=n.query.get("page");return d.isNumber(C)&&C<n.query.get("page_limit")&&(t.set({page:C+1}),t.run(v)),t},t.prevPage=function(v){var C=n.query.get("page");return d.isNumber(C)&&C>1&&(t.set({page:C-1}),t.run(v)),t}};l.Util.SearchSwitcher=function(e,t){var n=this,a=new l.Util.MultiSearch(null,!0,t);e.set({page:1}).setMute(!1),a.set({page:1}),this.uid=e.uid,this.run=function(s){return e.run(s),a.run(0),n},this.set=function(s){return e.set(s),a.set(d.omit(s,"page","facets")),n},this.nextPage=function(){return e.nextPage(),n},this.prevPage=function(){return e.prevPage(),n},this.switchTo=function(s){if(s!=e){if(e.setMute(!0).set({page:1}),a.searches.push(e),e=void 0,a.searches=d.reject(a.searches,function(i){if(i.uid==s)return e=i,!0}),!e)throw"Could not find a search with a UID of: "+s;n.uid=e.uid,e.setMute(!1)}return n}};l.Util.Section=function(e,t){this.start=Math.max(Math.min(e,t),0),this.end=Math.max(Math.max(e,t),0),this.inSection=function(n){return n>=this.start&&n<=this.end},this.overlaps=function(n){return this.inSection(n.start)||this.inSection(n.end)},this.calcLength=function(){return this.end-this.start+1},this.expanded=function(n){return this.shifted(-1*n,n)},this.shifted=function(n,a){return d.isNumber(a)||(a=n),new l.Util.Section(this.start+n,this.end+a)}};l.Util.deepClone=function(e){if(d.isFunction(e))return e;var t=!1;return d.isArray(e)?t="map":d.isObject(e)&&(t="mapObject"),t?d[t](e,function(n){return l.Util.deepClone(n)}):d.clone(e)};l.Util.escape=function(e){var t=document.createElement("div");return t.appendChild(document.createTextNode(e)),t.innerHTML};l.init=new l.Util.RequestBuffer({url:function(){return l.Settings.datastores_url},attempts:function(){return l.Settings.init_attempts},failure_message:function(){return l.Messenger.preset("failed_init")},edit_response:function(){},before_success:function(e){l.Settings.default_institution=e.default_institution,l.Settings.affiliation=e.affiliation,l.AllDatastores.array=d.map(e.response,function(t){return new l.Core.Datastore(t)})}}).request;l.Util.isDeepMatch=function(e,t){var n=d.isArray(e)&&d.isArray(t),a=d.isObject(e)&&d.isObject(t);return n&&t.length!=e.length||a&&d.keys(t).length!=d.keys(e).length?!1:n||a?d.every(t,function(s,i){return l.Util.isDeepMatch(e[i],s)}):e===t};l.Core.log=function(e,t){if(l.Settings.obnoxious){var n=l.Util.slice(arguments,2);n.unshift("[Pride: "+e+"] "+t),console.log.apply(console,n)}};l.FieldTree.parseField=function(e,t){if(t)try{return l.Parser.parse(t,{defaultFieldName:e})}catch(n){return console.log(n),new l.FieldTree.Raw(t)}else return{}};l.FieldTree=l.FieldTree||{};l.FieldTree.tokens=[":","AND","OR","+","-","(",")","*"," ",`
`,"	","\r"];l.FieldTree.tokenize=function(e){for(var t=[],n=0,a=null;n<e.length;){var s=e.slice(n),i=d.find(l.FieldTree.tokens,function(c){return new RegExp("^\\"+c).exec(s)});if(i)/\s/.exec(i)&&(a="whitespace"),a=i,n+=i.length;else{i=e.charAt(n),a="string",n++;var u=d.last(t);u&&u.type=="string"&&(i=t.pop().content+i)}t.push({type:a,content:i})}return t};l.Util.request=function(e){if(l.Core.log("Request","Sending HTTP request..."),l.Core.log("Request","URL",e.url),l.Core.log("Request","CONTENT",JSON.stringify(e.query)),!e.url)throw"No URL given to Pride.Util.request()";var t="get";e.query&&(t="post"),d.isNumber(e.attempts)||(e.attempts=l.Settings.connection_attempts),e.attempts-=1,(0,Kn.default)({url:e.url,data:JSON.stringify(e.query),type:"json",method:t,contentType:"application/json",withCredentials:!0,error:function(n){e.attempts<=0?(l.Core.log("Request","ERROR",n),l.Util.safeCall(e.failure,n),l.Messenger.sendMessage({summary:e.failure_message,class:"error"})):(l.Core.log("Request","Trying request again..."),window.setTimeout(function(){l.Util.request(e)},l.Settings.ms_between_attempts))},success:function(n){l.Core.log("Request","SUCCESS",n),l.Util.safeCall(e.success,n),l.Messenger.sendMessage({summary:e.success_message,class:"success"}),l.Messenger.sendMessageArray(n.messages)}})};l.requestRecord=function(e,t,n){n===void 0&&(n=function(i){});var a={complete:!1,source:l.AllDatastores.get(e).get("url")+"/record/"+t,names:[void 0]},s=new l.Core.Record(a);return s.renderFull(n),s};l.Util.safeCall=function(e){return d.isFunction(e)?e.apply(this,l.Util.slice(arguments,1)):e};l.Util.safeApply=function(e,t){return d.isFunction(e)?e.apply(this,t):e};l.Util.slice=function(e,t,n){return Array.prototype.slice.call(e,t,n)};l.AllDatastores={array:[],get:function(e){return d.find(this.array,function(t){return t.get("uid")==e})},newSearch:function(e){var t=d.find(this.array,function(n){return n.get("uid")==e});return t?t.baseSearch():void 0},each:function(e){return d.each(this.array,e),this}};l.Messenger=new l.Util.FuncBuffer(function(){var e=this.call;this.addObserver=this.add,this.removeObserver=this.remove,this.clearObservers=this.clear,this.call=void 0,this.add=void 0,this.remove=void 0,this.clear=void 0,this.sendMessage=function(t){return t.summary&&(t.class=t.class||"info",t.details=t.details||"",e(t.class,t),l.Core.log("Messenger","MESSAGE SENT",t)),this},this.sendMessageArray=function(t){var n=this;return d.each(t,function(a){n.sendMessage(a)}),this},this.preset=function(t){}});l.Parser=function(){"use strict";function e(a,s){function i(){this.constructor=a}i.prototype=s.prototype,a.prototype=new i}function t(a,s,i,u){this.message=a,this.expected=s,this.found=i,this.location=u,this.name="SyntaxError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,t)}e(t,Error),t.buildMessage=function(a,s){var i={literal:function(w){return'"'+c(w.text)+'"'},class:function(w){var _="",v;for(v=0;v<w.parts.length;v++)_+=w.parts[v]instanceof Array?h(w.parts[v][0])+"-"+h(w.parts[v][1]):h(w.parts[v]);return"["+(w.inverted?"^":"")+_+"]"},any:function(w){return"any character"},end:function(w){return"end of input"},other:function(w){return w.description}};function u(w){return w.charCodeAt(0).toString(16).toUpperCase()}function c(w){return w.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(_){return"\\x0"+u(_)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(_){return"\\x"+u(_)})}function h(w){return w.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(_){return"\\x0"+u(_)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(_){return"\\x"+u(_)})}function m(w){return i[w.type](w)}function F(w){var _=new Array(w.length),v,C;for(v=0;v<w.length;v++)_[v]=m(w[v]);if(_.sort(),_.length>0){for(v=1,C=1;v<_.length;v++)_[v-1]!==_[v]&&(_[C]=_[v],C++);_.length=C}switch(_.length){case 1:return _[0];case 2:return _[0]+" or "+_[1];default:return _.slice(0,-1).join(", ")+", or "+_[_.length-1]}}function T(w){return w?'"'+c(w)+'"':"end of input"}return"Expected "+F(a)+" but "+T(s)+" found."};function n(a,s){s=s!==void 0?s:{};var i={},u={start:Gr},c=Gr,h=function(f){return f},m=function(f,p,x){return new l.FieldTree.FieldBoolean(p,f,x)},F=function(f,p){return p?[f,p]:f},T=function(f){return f},w=":",_=ge(":",!1),v=function(f,p){return new l.FieldTree.Field(f,p)},C=function(f){return new l.FieldTree.Field(Fi,f)},M=function(f){return f.join("")},X=function(f,p){return p?f.concat(p):f},Ee=function(f,p){return[new l.FieldTree.Literal(f+p.join(""))]},oe=function(f){return[new l.FieldTree.Literal(f.join(""))]},te=function(f){return[new l.FieldTree.Literal('"'+f.join("")+'"')]},Yn=function(f){return f},Hr="AND",Zn=ge("AND",!1),zr="OR",jn=ge("OR",!1),kr="NOT",ei=ge("NOT",!1),ti="'",ri=ge("'",!1),ni=/^[^']/,ii=ve(["'"],!0,!1),oi='"',ai=ge('"',!1),si=/^[^"]/,ui=ve(['"'],!0,!1),fi=/^[^ \t\r\n:'"()]/,li=ve([" ","	","\r",`
`,":","'",'"',"(",")"],!0,!1),ci=/^[^ \t\r\n():]/,pi=ve([" ","	","\r",`
`,"(",")",":"],!0,!1),mi=/^[^ \t\r\n'"():]/,di=ve([" ","	","\r",`
`,"'",'"',"(",")",":"],!0,!1),Vr=/^[ \t\r\n]/,Xr=ve([" ","	","\r",`
`],!1,!1),g=0,P=0,st=[{line:1,column:1}],K=0,Ut=[],N=0,ut;if("startRule"in s){if(!(s.startRule in u))throw new Error(`Can't start parsing from rule "`+s.startRule+'".');c=u[s.startRule]}function Wi(){return a.substring(P,g)}function Gi(){return be(P,g)}function Ji(f,p){throw p=p!==void 0?p:be(P,g),Wr([gi(f)],a.substring(P,g),p)}function Ki(f,p){throw p=p!==void 0?p:be(P,g),vi(f,p)}function ge(f,p){return{type:"literal",text:f,ignoreCase:p}}function ve(f,p,x){return{type:"class",parts:f,inverted:p,ignoreCase:x}}function Yi(){return{type:"any"}}function hi(){return{type:"end"}}function gi(f){return{type:"other",description:f}}function Qr(f){var p=st[f],x;if(p)return p;for(x=f-1;!st[x];)x--;for(p=st[x],p={line:p.line,column:p.column};x<f;)a.charCodeAt(x)===10?(p.line++,p.column=1):p.column++,x++;return st[f]=p,p}function be(f,p){var x=Qr(f),S=Qr(p);return{start:{offset:f,line:x.line,column:x.column},end:{offset:p,line:S.line,column:S.column}}}function B(f){g<K||(g>K&&(K=g,Ut=[]),Ut.push(f))}function vi(f,p){return new t(f,null,null,p)}function Wr(f,p,x){return new t(t.buildMessage(f,p),f,p,x)}function Gr(){var f,p,x;return f=g,p=Jr(),p!==i?(x=Ci(),x!==i?(P=f,p=h(p),f=p):(g=f,f=i)):(g=f,f=i),f}function Jr(){var f,p,x,S,re,$t;return f=g,p=Mt(),p!==i?(x=Ue(),x!==i?(S=Ai(),S!==i?(re=Ue(),re!==i?($t=Jr(),$t!==i?(P=f,p=m(p,S,$t),f=p):(g=f,f=i)):(g=f,f=i)):(g=f,f=i)):(g=f,f=i)):(g=f,f=i),f===i&&(f=Kr()),f}function Kr(){var f,p,x;return f=Mt(),f===i&&(f=g,p=Mt(),p!==i?(x=xi(),x===i&&(x=null),x!==i?(P=f,p=F(p,x),f=p):(g=f,f=i)):(g=f,f=i)),f}function xi(){var f,p,x;return f=g,p=Ue(),p!==i?(x=Kr(),x!==i?(P=f,p=T(x),f=p):(g=f,f=i)):(g=f,f=i),f}function Mt(){var f,p,x,S;return f=g,p=yi(),p!==i?(a.charCodeAt(g)===58?(x=w,g++):(x=i,N===0&&B(_)),x!==i?(S=Pt(),S!==i?(P=f,p=v(p,S),f=p):(g=f,f=i)):(g=f,f=i)):(g=f,f=i),f===i&&(f=g,p=Pt(),p!==i&&(P=f,p=C(p)),f=p),f}function yi(){var f,p,x;if(f=g,p=[],x=tn(),x!==i)for(;x!==i;)p.push(x),x=tn();else p=i;return p!==i&&(P=f,p=M(p)),f=p,f}function Pt(){var f,p,x;return f=g,p=_i(),p!==i?(x=wi(),x===i&&(x=null),x!==i?(P=f,p=X(p,x),f=p):(g=f,f=i)):(g=f,f=i),f}function wi(){var f,p,x;return f=g,p=Ue(),p!==i?(x=Pt(),x!==i?(P=f,p=T(x),f=p):(g=f,f=i)):(g=f,f=i),f}function _i(){var f,p,x,S,re;if(f=g,p=g,N++,x=Nt(),N--,x===i?p=void 0:(g=p,p=i),p!==i)if(x=Dt(),x!==i){if(S=[],re=rn(),re!==i)for(;re!==i;)S.push(re),re=rn();else S=i;S!==i?(P=f,p=Ee(x,S),f=p):(g=f,f=i)}else g=f,f=i;else g=f,f=i;if(f===i){if(f=g,p=g,N++,x=Nt(),N--,x===i?p=void 0:(g=p,p=i),p!==i){if(x=[],S=Dt(),S!==i)for(;S!==i;)x.push(S),S=Dt();else x=i;x!==i?(P=f,p=oe(x),f=p):(g=f,f=i)}else g=f,f=i;if(f===i){if(f=g,p=Yr(),p!==i){for(x=[],S=Zr();S!==i;)x.push(S),S=Zr();x!==i?(S=Yr(),S!==i?(P=f,p=te(x),f=p):(g=f,f=i)):(g=f,f=i)}else g=f,f=i;if(f===i)if(f=g,p=jr(),p!==i){for(x=[],S=en();S!==i;)x.push(S),S=en();x!==i?(S=jr(),S!==i?(P=f,p=te(x),f=p):(g=f,f=i)):(g=f,f=i)}else g=f,f=i}}return f}function Ai(){var f,p;return f=g,p=Nt(),p!==i&&(P=f,p=Yn(p)),f=p,f}function Nt(){var f;return a.substr(g,3)===Hr?(f=Hr,g+=3):(f=i,N===0&&B(Zn)),f===i&&(a.substr(g,2)===zr?(f=zr,g+=2):(f=i,N===0&&B(jn)),f===i&&(a.substr(g,3)===kr?(f=kr,g+=3):(f=i,N===0&&B(ei)))),f}function Yr(){var f;return a.charCodeAt(g)===39?(f=ti,g++):(f=i,N===0&&B(ri)),f}function Zr(){var f;return ni.test(a.charAt(g))?(f=a.charAt(g),g++):(f=i,N===0&&B(ii)),f}function jr(){var f;return a.charCodeAt(g)===34?(f=oi,g++):(f=i,N===0&&B(ai)),f}function en(){var f;return si.test(a.charAt(g))?(f=a.charAt(g),g++):(f=i,N===0&&B(ui)),f}function tn(){var f;return fi.test(a.charAt(g))?(f=a.charAt(g),g++):(f=i,N===0&&B(li)),f}function rn(){var f;return ci.test(a.charAt(g))?(f=a.charAt(g),g++):(f=i,N===0&&B(pi)),f}function Dt(){var f;return mi.test(a.charAt(g))?(f=a.charAt(g),g++):(f=i,N===0&&B(di)),f}function Ue(){var f,p;if(f=[],Vr.test(a.charAt(g))?(p=a.charAt(g),g++):(p=i,N===0&&B(Xr)),p!==i)for(;p!==i;)f.push(p),Vr.test(a.charAt(g))?(p=a.charAt(g),g++):(p=i,N===0&&B(Xr));else f=i;return f}function Ci(){var f;return f=Ue(),f===i&&(f=null),f}var Fi=s.defaultFieldName||"all_fields";if(ut=c(),ut!==i&&g===a.length)return ut;throw ut!==i&&g<a.length&&B(hi()),Wr(Ut,K<a.length?a.charAt(K):null,K<a.length?be(K,K+1):be(K,K))}return{SyntaxError:t,parse:n}}();l.PreferenceEngine={selectedRecords:null,engine:null,selected:function(e){return this.engine?(this.selectedRecords[e.datastore]||{})[e.uid]:!1},registerEngine:function(e){return this.engine=e,e?(this.updateSelectedRecords(this.engine.listRecords()),this.engine.addObserver(function(t){return function(n){t.updateSelectedRecords(n)}}(this)),this):this},blankList:function(){return{mirlyn:{},articlesplus:{},databases:{},journals:{},website:{}}},updateSelectedRecords:function(e){if(this.selectedRecords=this.selectedRecords||this.blankList(),e.forEach)return e.forEach(function(n){this.selectedRecords[n.datastore]=this.selectedRecords[n.datastore]||{},this.selectedRecords[n.datastore][n.uid]=!0},this),this;for(var t in e)e.hasOwnProperty(t)&&(this.selectedRecords[t]={},e[t].forEach(function(n){return function(a){this.selectedRecords[n][a.uid]=!0}}(t),this));return this}};
/*! Bundled license information:

reqwest/reqwest.js:
  (*!
    * Reqwest! A general purpose XHR connection manager
    * license MIT (c) Dustin Diaz 2015
    * https://github.com/ded/reqwest
    *)
*/
